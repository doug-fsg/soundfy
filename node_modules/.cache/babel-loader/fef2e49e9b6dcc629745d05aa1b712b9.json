{"remainingRequest":"C:\\teste-login\\node_modules\\babel-loader\\lib\\index.js!C:\\teste-login\\node_modules\\eslint-loader\\index.js??ref--12-0!C:\\teste-login\\src\\Track.js","dependencies":[{"path":"C:\\teste-login\\src\\Track.js","mtime":1713796966833},{"path":"C:\\teste-login\\babel.config.js","mtime":1713903577360},{"path":"C:\\teste-login\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1713973011099},{"path":"C:\\teste-login\\node_modules\\babel-loader\\lib\\index.js","mtime":1713973011327},{"path":"C:\\teste-login\\node_modules\\eslint-loader\\index.js","mtime":1713973006832}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi90ZXN0ZS1sb2dpbi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2suanMiOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L3Rlc3RlLWxvZ2luL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmVycm9yLmNhdXNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LWJ1ZmZlci5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LWJ1ZmZlci5kZXRhY2hlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LWJ1ZmZlci50cmFuc2Zlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LWJ1ZmZlci50cmFuc2Zlci10by1maXhlZC1sZW5ndGguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmxvYXQzMi1hcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmF0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuY29weS13aXRoaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5ldmVyeS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbGwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtbGFzdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtbGFzdC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbmRleC1vZi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lmxhc3QtaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UtcmlnaHQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZXZlcnNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2V0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zb21lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29ydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnN1YmFycmF5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tbG9jYWxlLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLXJldmVyc2VkLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tc29ydGVkLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkud2l0aC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgX2Fzc2lnbiBmcm9tICJsb2Rhc2guYXNzaWduIjsKaW1wb3J0IF9mb3JPd24gZnJvbSAibG9kYXNoLmZvcm93biI7CmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gInV1aWQiOwppbXBvcnQgaCBmcm9tICJ2aXJ0dWFsLWRvbS9oIjsKaW1wb3J0IGV4dHJhY3RQZWFrcyBmcm9tICJ3ZWJhdWRpby1wZWFrcyI7CmltcG9ydCB7IEZBREVJTiwgRkFERU9VVCB9IGZyb20gImZhZGUtbWFrZXIiOwppbXBvcnQgeyBzZWNvbmRzVG9QaXhlbHMsIHNlY29uZHNUb1NhbXBsZXMgfSBmcm9tICIuL3V0aWxzL2NvbnZlcnNpb25zIjsKaW1wb3J0IHN0YXRlQ2xhc3NlcyBmcm9tICIuL3RyYWNrL3N0YXRlcyI7CmltcG9ydCBDYW52YXNIb29rIGZyb20gIi4vcmVuZGVyL0NhbnZhc0hvb2siOwppbXBvcnQgRmFkZUNhbnZhc0hvb2sgZnJvbSAiLi9yZW5kZXIvRmFkZUNhbnZhc0hvb2siOwppbXBvcnQgVm9sdW1lU2xpZGVySG9vayBmcm9tICIuL3JlbmRlci9Wb2x1bWVTbGlkZXJIb29rIjsKaW1wb3J0IFN0ZXJlb1BhblNsaWRlckhvb2sgZnJvbSAiLi9yZW5kZXIvU3RlcmVvUGFuU2xpZGVySG9vayI7CnZhciBNQVhfQ0FOVkFTX1dJRFRIID0gMTAwMDsKdmFyIF9kZWZhdWx0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfZGVmYXVsdCk7CiAgICB0aGlzLm5hbWUgPSAiVW50aXRsZWQiOwogICAgdGhpcy5jdXN0b21DbGFzcyA9IHVuZGVmaW5lZDsKICAgIHRoaXMud2F2ZU91dGxpbmVDb2xvciA9IHVuZGVmaW5lZDsKICAgIHRoaXMuZ2FpbiA9IDE7CiAgICB0aGlzLmZhZGVzID0ge307CiAgICB0aGlzLnBlYWtEYXRhID0gewogICAgICB0eXBlOiAiV2ViQXVkaW8iLAogICAgICBtb25vOiBmYWxzZQogICAgfTsKICAgIHRoaXMuY3VlSW4gPSAwOwogICAgdGhpcy5jdWVPdXQgPSAwOwogICAgdGhpcy5kdXJhdGlvbiA9IDA7CiAgICB0aGlzLnN0YXJ0VGltZSA9IDA7CiAgICB0aGlzLmVuZFRpbWUgPSAwOwogICAgdGhpcy5zdGVyZW9QYW4gPSAwOwogICAgdGhpcy5oZXJ0empzVHJhY2sgPSB1bmRlZmluZWQ7CiAgfQogIHJldHVybiBfY3JlYXRlQ2xhc3MoX2RlZmF1bHQsIFt7CiAgICBrZXk6ICJzZXRIZXJ0empzVHJhY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEhlcnR6anNUcmFjayhoZXJ0anpUcmFjaykgewogICAgICB0aGlzLmhlcnR6anNUcmFjayA9IGhlcnRqelRyYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEV2ZW50RW1pdHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RXZlbnRFbWl0dGVyKGVlKSB7CiAgICAgIHRoaXMuZWUgPSBlZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXROYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXROYW1lKG5hbWUpIHsKICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDdXN0b21DbGFzcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q3VzdG9tQ2xhc3MoY2xhc3NOYW1lKSB7CiAgICAgIHRoaXMuY3VzdG9tQ2xhc3MgPSBjbGFzc05hbWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0V2F2ZU91dGxpbmVDb2xvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0V2F2ZU91dGxpbmVDb2xvcihjb2xvcikgewogICAgICB0aGlzLndhdmVPdXRsaW5lQ29sb3IgPSBjb2xvcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDdWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRDdWVzKGN1ZUluLCBjdWVPdXQpIHsKICAgICAgaWYgKGN1ZU91dCA8IGN1ZUluKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjdWUgb3V0IGNhbm5vdCBiZSBsZXNzIHRoYW4gY3VlIGluIik7CiAgICAgIH0KICAgICAgdGhpcy5jdWVJbiA9IGN1ZUluOwogICAgICB0aGlzLmN1ZU91dCA9IGN1ZU91dDsKICAgICAgdGhpcy5kdXJhdGlvbiA9IHRoaXMuY3VlT3V0IC0gdGhpcy5jdWVJbjsKICAgICAgdGhpcy5lbmRUaW1lID0gdGhpcy5zdGFydFRpbWUgKyB0aGlzLmR1cmF0aW9uOwogICAgfQoKICAgIC8qDQogICAgICogICBzdGFydCwgZW5kIGluIHNlY29uZHMgcmVsYXRpdmUgdG8gdGhlIGVudGlyZSBwbGF5bGlzdC4NCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJ0cmltIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0cmltKHN0YXJ0LCBlbmQpIHsKICAgICAgdmFyIHRyYWNrU3RhcnQgPSB0aGlzLmdldFN0YXJ0VGltZSgpOwogICAgICB2YXIgdHJhY2tFbmQgPSB0aGlzLmdldEVuZFRpbWUoKTsKICAgICAgdmFyIG9mZnNldCA9IHRoaXMuY3VlSW4gLSB0cmFja1N0YXJ0OwogICAgICBpZiAodHJhY2tTdGFydCA8PSBzdGFydCAmJiB0cmFja0VuZCA+PSBzdGFydCB8fCB0cmFja1N0YXJ0IDw9IGVuZCAmJiB0cmFja0VuZCA+PSBlbmQpIHsKICAgICAgICB2YXIgY3VlSW4gPSBzdGFydCA8IHRyYWNrU3RhcnQgPyB0cmFja1N0YXJ0IDogc3RhcnQ7CiAgICAgICAgdmFyIGN1ZU91dCA9IGVuZCA+IHRyYWNrRW5kID8gdHJhY2tFbmQgOiBlbmQ7CiAgICAgICAgdGhpcy5zZXRDdWVzKGN1ZUluICsgb2Zmc2V0LCBjdWVPdXQgKyBvZmZzZXQpOwogICAgICAgIGlmIChzdGFydCA+IHRyYWNrU3RhcnQpIHsKICAgICAgICAgIHRoaXMuc2V0U3RhcnRUaW1lKHN0YXJ0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVBcnJheUJ1ZmZlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQXJyYXlCdWZmZXIocG9pbnQxLCBwb2ludDIsIGF1ZGlvQ29udGV4dCkgewogICAgICB2YXIgbmV3QXJyYXlCdWZmZXI7CiAgICAgIHZhciB0cmFja1N0YXJ0ID0gdGhpcy5nZXRTdGFydFRpbWUoKTsKICAgICAgdmFyIHRyYWNrRW5kID0gdGhpcy5nZXRFbmRUaW1lKCk7CiAgICAgIHZhciBzdGFydCA9IHBvaW50MTsKICAgICAgdmFyIGVuZCA9IHBvaW50MjsKICAgICAgdmFyIHRpbWVTcGxpdE9mZnNldCA9IHN0YXJ0IC0gdGhpcy5nZXRTdGFydFRpbWUoKTsKICAgICAgaWYgKHRpbWVTcGxpdE9mZnNldCA8IDApIHsKICAgICAgICAvLyBvdXRzaWRlIGludGVydmFsIGxlZnQKICAgICAgICB0aW1lU3BsaXRPZmZzZXQgPSAwOwogICAgICB9CiAgICAgIHZhciBmaXJzdFBhcnRQZXJjZW50YWdlID0gdGltZVNwbGl0T2Zmc2V0IC8gdGhpcy5kdXJhdGlvbjsKICAgICAgdmFyIHNlY29uZFRpbWVTcGxpdE9mZnNldCA9IGVuZCAtIHRoaXMuZ2V0U3RhcnRUaW1lKCk7CiAgICAgIHZhciBzZWNvbmRQYXJ0UGVyY2VudGFnZSA9ICh0aGlzLmR1cmF0aW9uIC0gc2Vjb25kVGltZVNwbGl0T2Zmc2V0KSAvIHRoaXMuZHVyYXRpb247CiAgICAgIGlmIChzZWNvbmRQYXJ0UGVyY2VudGFnZSA8IDApIHsKICAgICAgICAvLyBvdXRzaWRlIGludGVydmFsIHJpZ2h0CiAgICAgICAgc2Vjb25kUGFydFBlcmNlbnRhZ2UgPSAwOwogICAgICB9CiAgICAgIGlmIChzdGFydCA8PSB0cmFja0VuZCAmJiBlbmQgPj0gdHJhY2tTdGFydCkgewogICAgICAgIHZhciBjaGFubmVscyA9IHRoaXMuYnVmZmVyLm51bWJlck9mQ2hhbm5lbHM7CiAgICAgICAgdmFyIGZpcnN0UGFydE5ld0xlbmd0aCA9IGZpcnN0UGFydFBlcmNlbnRhZ2UgKiB0aGlzLmJ1ZmZlci5sZW5ndGg7CiAgICAgICAgdmFyIHNlY29uZFBhcnROZXdMZW5ndGggPSBzZWNvbmRQYXJ0UGVyY2VudGFnZSAqIHRoaXMuYnVmZmVyLmxlbmd0aDsKICAgICAgICBuZXdBcnJheUJ1ZmZlciA9IGF1ZGlvQ29udGV4dC5jcmVhdGVCdWZmZXIoY2hhbm5lbHMsIGZpcnN0UGFydE5ld0xlbmd0aCArIHNlY29uZFBhcnROZXdMZW5ndGgsIHRoaXMuYnVmZmVyLnNhbXBsZVJhdGUpOwogICAgICAgIHZhciBhcnJheUZpcnN0UGFydCA9IG5ldyBGbG9hdDMyQXJyYXkoZmlyc3RQYXJ0TmV3TGVuZ3RoKTsKICAgICAgICB2YXIgYXJyYXlTZWNvbmRQYXJ0ID0gbmV3IEZsb2F0MzJBcnJheShzZWNvbmRQYXJ0TmV3TGVuZ3RoKTsKICAgICAgICBmb3IgKHZhciBjaGFubmVsID0gMDsgY2hhbm5lbCA8IGNoYW5uZWxzOyBjaGFubmVsKyspIHsKICAgICAgICAgIHRoaXMuYnVmZmVyLmNvcHlGcm9tQ2hhbm5lbChhcnJheUZpcnN0UGFydCwgY2hhbm5lbCwgMCk7CiAgICAgICAgICB0aGlzLmJ1ZmZlci5jb3B5RnJvbUNoYW5uZWwoYXJyYXlTZWNvbmRQYXJ0LCBjaGFubmVsLCB0aGlzLmJ1ZmZlci5sZW5ndGggLSBzZWNvbmRQYXJ0TmV3TGVuZ3RoKTsKICAgICAgICAgIG5ld0FycmF5QnVmZmVyLmNvcHlUb0NoYW5uZWwoYXJyYXlGaXJzdFBhcnQsIGNoYW5uZWwsIDApOwogICAgICAgICAgbmV3QXJyYXlCdWZmZXIuY29weVRvQ2hhbm5lbChhcnJheVNlY29uZFBhcnQsIGNoYW5uZWwsIGZpcnN0UGFydE5ld0xlbmd0aCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBuZXdBcnJheUJ1ZmZlcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyYXpvckN1dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmF6b3JDdXQocG9pbnQsIGF1ZGlvQ29udGV4dCwgdHJhY2spIHsKICAgICAgdmFyIG5ld0FycmF5QnVmZmVyMSA9IHRoaXMuY3JlYXRlQXJyYXlCdWZmZXIocG9pbnQsIHRyYWNrLmVuZFRpbWUsIGF1ZGlvQ29udGV4dCk7CiAgICAgIHZhciBuZXdBcnJheUJ1ZmZlcjIgPSB0aGlzLmNyZWF0ZUFycmF5QnVmZmVyKHRyYWNrLnN0YXJ0VGltZSwgcG9pbnQsIGF1ZGlvQ29udGV4dCk7CiAgICAgIHZhciByYXpvckN1dE9iamVjdCA9IHsKICAgICAgICBUcmFjazogdHJhY2ssCiAgICAgICAgUG9pbnQ6IHBvaW50LAogICAgICAgIGJ1ZmZlcjE6IG5ld0FycmF5QnVmZmVyMSwKICAgICAgICBidWZmZXIyOiBuZXdBcnJheUJ1ZmZlcjIKICAgICAgfTsKICAgICAgcmV0dXJuIHRoaXMuZWUuZW1pdCgicmF6b3JDdXRGaW5pc2hlZCIsIHJhem9yQ3V0T2JqZWN0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVQYXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVQYXJ0KHBvaW50MSwgcG9pbnQyLCBhdWRpb0NvbnRleHQsIHRyYWNrKSB7CiAgICAgIHRoaXMuZWUuZW1pdCgic2F2ZUN1dE1hbmlwdWxhdGlvbiIsIHRoaXMuYnVmZmVyLCB0cmFjayk7CiAgICAgIHZhciB0cmFja1N0YXJ0ID0gdGhpcy5nZXRTdGFydFRpbWUoKTsKICAgICAgdmFyIHRyYWNrRW5kID0gdGhpcy5nZXRFbmRUaW1lKCk7CiAgICAgIHZhciBzdGFydDsKICAgICAgdmFyIGVuZDsKICAgICAgaWYgKHBvaW50MSA8PSBwb2ludDIpIHsKICAgICAgICBzdGFydCA9IHBvaW50MTsKICAgICAgICBlbmQgPSBwb2ludDI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhcnQgPSBwb2ludDI7CiAgICAgICAgZW5kID0gcG9pbnQxOwogICAgICB9CiAgICAgIGlmIChzdGFydCA8PSB0cmFja1N0YXJ0KSB7CiAgICAgICAgc3RhcnQgPSB0cmFja1N0YXJ0OwogICAgICB9CiAgICAgIGlmIChlbmQgPj0gdHJhY2tFbmQpIHsKICAgICAgICBlbmQgPSB0cmFja0VuZDsKICAgICAgfQogICAgICB2YXIgbmV3X2N1ZUluID0gdGhpcy5jdWVJbjsKICAgICAgdmFyIG5ld19jdWVPdXQgPSB0aGlzLmN1ZU91dCAtIChlbmQgLSBzdGFydCk7CiAgICAgIHZhciBidWZmZXJfZHVyYXRpb24gPSB0aGlzLmJ1ZmZlci5sZW5ndGggKiAyIC8gKHRoaXMuYnVmZmVyLnNhbXBsZVJhdGUgKiB0aGlzLmJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzKTsKICAgICAgdmFyIHRpbWVTcGxpdE9mZnNldCA9IHN0YXJ0IC0gdGhpcy5nZXRTdGFydFRpbWUoKSArIHRoaXMuY3VlSW47CiAgICAgIGNvbnNvbGUubG9nKCJ0aW1lU3BsaXRPZmZzZXQ6ICIgKyB0aW1lU3BsaXRPZmZzZXQpOwogICAgICBpZiAodGltZVNwbGl0T2Zmc2V0IDwgMCkgewogICAgICAgIC8vIG91dHNpZGUgaW50ZXJ2YWwgbGVmdAogICAgICAgIHRpbWVTcGxpdE9mZnNldCA9IDA7CiAgICAgIH0KICAgICAgdmFyIGZpcnN0UGFydFBlcmNlbnRhZ2UgPSB0aW1lU3BsaXRPZmZzZXQgLyBidWZmZXJfZHVyYXRpb247CiAgICAgIHZhciBzZWNvbmRUaW1lU3BsaXRPZmZzZXQgPSBlbmQgLSB0aGlzLmdldFN0YXJ0VGltZSgpICsgdGhpcy5jdWVJbjsKICAgICAgdmFyIHNlY29uZFBhcnRQZXJjZW50YWdlID0gKGJ1ZmZlcl9kdXJhdGlvbiAtIHNlY29uZFRpbWVTcGxpdE9mZnNldCkgLyBidWZmZXJfZHVyYXRpb247CiAgICAgIGlmIChzZWNvbmRQYXJ0UGVyY2VudGFnZSA8IDApIHsKICAgICAgICAvLyBvdXRzaWRlIGludGVydmFsIHJpZ2h0CiAgICAgICAgc2Vjb25kUGFydFBlcmNlbnRhZ2UgPSAwOwogICAgICB9CiAgICAgIGlmIChzdGFydCA8PSB0cmFja0VuZCAmJiBlbmQgPj0gdHJhY2tTdGFydCkgewogICAgICAgIHZhciBjaGFubmVscyA9IHRoaXMuYnVmZmVyLm51bWJlck9mQ2hhbm5lbHM7CiAgICAgICAgdmFyIG5ld0FycmF5QnVmZmVyOwogICAgICAgIHZhciBmaXJzdFBhcnROZXdMZW5ndGggPSBmaXJzdFBhcnRQZXJjZW50YWdlICogdGhpcy5idWZmZXIubGVuZ3RoOwogICAgICAgIHZhciBzZWNvbmRQYXJ0TmV3TGVuZ3RoID0gc2Vjb25kUGFydFBlcmNlbnRhZ2UgKiB0aGlzLmJ1ZmZlci5sZW5ndGg7CiAgICAgICAgbmV3QXJyYXlCdWZmZXIgPSBhdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyKGNoYW5uZWxzLCBmaXJzdFBhcnROZXdMZW5ndGggKyBzZWNvbmRQYXJ0TmV3TGVuZ3RoLCB0aGlzLmJ1ZmZlci5zYW1wbGVSYXRlKTsKICAgICAgICB2YXIgYXJyYXlGaXJzdFBhcnQgPSBuZXcgRmxvYXQzMkFycmF5KGZpcnN0UGFydE5ld0xlbmd0aCk7CiAgICAgICAgdmFyIGFycmF5U2Vjb25kUGFydCA9IG5ldyBGbG9hdDMyQXJyYXkoc2Vjb25kUGFydE5ld0xlbmd0aCk7CiAgICAgICAgZm9yICh2YXIgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBjaGFubmVsczsgY2hhbm5lbCsrKSB7CiAgICAgICAgICB0aGlzLmJ1ZmZlci5jb3B5RnJvbUNoYW5uZWwoYXJyYXlGaXJzdFBhcnQsIGNoYW5uZWwsIDApOwogICAgICAgICAgdGhpcy5idWZmZXIuY29weUZyb21DaGFubmVsKGFycmF5U2Vjb25kUGFydCwgY2hhbm5lbCwgdGhpcy5idWZmZXIubGVuZ3RoIC0gc2Vjb25kUGFydE5ld0xlbmd0aCk7CiAgICAgICAgICBuZXdBcnJheUJ1ZmZlci5jb3B5VG9DaGFubmVsKGFycmF5Rmlyc3RQYXJ0LCBjaGFubmVsLCAwKTsKICAgICAgICAgIG5ld0FycmF5QnVmZmVyLmNvcHlUb0NoYW5uZWwoYXJyYXlTZWNvbmRQYXJ0LCBjaGFubmVsLCBmaXJzdFBhcnROZXdMZW5ndGgpOwogICAgICAgIH0KICAgICAgICB2YXIgZmFkZXMgPSB0cmFjay5mYWRlczsKICAgICAgICBpZiAodHlwZW9mIGZhZGVzICE9PSAidW5kZWZpbmVkIiAmJiBPYmplY3Qua2V5cyhmYWRlcykubGVuZ3RoID4gMCkgewogICAgICAgICAgdmFyIGZhZGVJbkR1cmF0aW9uID0gMCwKICAgICAgICAgICAgZmFkZU91dER1cmF0aW9uID0gMDsKICAgICAgICAgIE9iamVjdC5rZXlzKGZhZGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgICAgaWYgKGZhZGVzW2tleV0udHlwZSA9PT0gIkZhZGVJbiIpIHsKICAgICAgICAgICAgICBmYWRlSW5EdXJhdGlvbiA9IGZhZGVzW2tleV0uZW5kIC0gZmFkZXNba2V5XS5zdGFydDsKICAgICAgICAgICAgfSBlbHNlIGlmIChmYWRlc1trZXldLnR5cGUgPT09ICJGYWRlT3V0IikgewogICAgICAgICAgICAgIGZhZGVPdXREdXJhdGlvbiA9IGZhZGVzW2tleV0uZW5kIC0gZmFkZXNba2V5XS5zdGFydDsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgdG90YWxGYWRlc0R1cmF0aW9uID0gZmFkZUluRHVyYXRpb24gKyBmYWRlT3V0RHVyYXRpb247CiAgICAgICAgICBpZiAodG90YWxGYWRlc0R1cmF0aW9uID49IG5ld0FycmF5QnVmZmVyLmR1cmF0aW9uKSB7CiAgICAgICAgICAgIC8vIE9ubHkgcmVtb3ZlIGZhZGVzIGlmIHRoZXkgd2lsbCBpbnRlcnNlY3Qgb3IgYmUgbG9uZ2VyIHRoYW4gbmV3IGFycmF5QnVmZmVyIGFmdGVyIGN1dAogICAgICAgICAgICBpZiAodGhpcy5mYWRlSW4pIHsKICAgICAgICAgICAgICB0aGlzLnJlbW92ZUZhZGUodGhpcy5mYWRlSW4pOwogICAgICAgICAgICAgIHRoaXMuZmFkZUluID0gdW5kZWZpbmVkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLmZhZGVPdXQpIHsKICAgICAgICAgICAgICB0aGlzLnJlbW92ZUZhZGUodGhpcy5mYWRlT3V0KTsKICAgICAgICAgICAgICB0aGlzLmZhZGVPdXQgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXdBcnJheUJ1ZmZlcjsKICAgICAgICB0aGlzLnNldEN1ZXMobmV3X2N1ZUluLCBuZXdfY3VlT3V0KTsKICAgICAgICB0aGlzLnBsYXlvdXQuYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRTdGFydFRpbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0YXJ0VGltZShzdGFydCkgewogICAgICB0aGlzLnN0YXJ0VGltZSA9IHN0YXJ0OwogICAgICB0aGlzLmVuZFRpbWUgPSBzdGFydCArIHRoaXMuZHVyYXRpb247CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0UGxheW91dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UGxheW91dChwbGF5b3V0KSB7CiAgICAgIHRoaXMucGxheW91dCA9IHBsYXlvdXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0T2ZmbGluZVBsYXlvdXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldE9mZmxpbmVQbGF5b3V0KHBsYXlvdXQpIHsKICAgICAgdGhpcy5vZmZsaW5lUGxheW91dCA9IHBsYXlvdXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RW5hYmxlZFN0YXRlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RW5hYmxlZFN0YXRlcygpIHsKICAgICAgdmFyIGVuYWJsZWRTdGF0ZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICB2YXIgZGVmYXVsdFN0YXRlc0VuYWJsZWQgPSB7CiAgICAgICAgY3Vyc29yOiB0cnVlLAogICAgICAgIGZhZGVpbjogdHJ1ZSwKICAgICAgICBmYWRlb3V0OiB0cnVlLAogICAgICAgIHNlbGVjdDogdHJ1ZSwKICAgICAgICBzaGlmdDogdHJ1ZQogICAgICB9OwogICAgICB0aGlzLmVuYWJsZWRTdGF0ZXMgPSBfYXNzaWduKHt9LCBkZWZhdWx0U3RhdGVzRW5hYmxlZCwgZW5hYmxlZFN0YXRlcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RmFkZUluIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGYWRlSW4oZHVyYXRpb24pIHsKICAgICAgdmFyIHNoYXBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAibG9nYXJpdGhtaWMiOwogICAgICBpZiAoZHVyYXRpb24gPiB0aGlzLmR1cmF0aW9uKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIEZhZGUgSW4iKTsKICAgICAgfQogICAgICB2YXIgZmFkZSA9IHsKICAgICAgICBzaGFwZTogc2hhcGUsCiAgICAgICAgc3RhcnQ6IDAsCiAgICAgICAgZW5kOiBkdXJhdGlvbgogICAgICB9OwogICAgICBpZiAodGhpcy5mYWRlSW4pIHsKICAgICAgICB0aGlzLnJlbW92ZUZhZGUodGhpcy5mYWRlSW4pOwogICAgICAgIHRoaXMuZmFkZUluID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIHRoaXMuZmFkZUluID0gdGhpcy5zYXZlRmFkZShGQURFSU4sIGZhZGUuc2hhcGUsIGZhZGUuc3RhcnQsIGZhZGUuZW5kKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGYWRlT3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGYWRlT3V0KGR1cmF0aW9uKSB7CiAgICAgIHZhciBzaGFwZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogImxvZ2FyaXRobWljIjsKICAgICAgaWYgKGR1cmF0aW9uID4gdGhpcy5kdXJhdGlvbikgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBGYWRlIE91dCIpOwogICAgICB9CiAgICAgIHZhciBmYWRlID0gewogICAgICAgIHNoYXBlOiBzaGFwZSwKICAgICAgICBzdGFydDogdGhpcy5kdXJhdGlvbiAtIGR1cmF0aW9uLAogICAgICAgIGVuZDogdGhpcy5kdXJhdGlvbgogICAgICB9OwogICAgICBpZiAodGhpcy5mYWRlT3V0KSB7CiAgICAgICAgdGhpcy5yZW1vdmVGYWRlKHRoaXMuZmFkZU91dCk7CiAgICAgICAgdGhpcy5mYWRlT3V0ID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIHRoaXMuZmFkZU91dCA9IHRoaXMuc2F2ZUZhZGUoRkFERU9VVCwgZmFkZS5zaGFwZSwgZmFkZS5zdGFydCwgZmFkZS5lbmQpOwogICAgfQogIH0sIHsKICAgIGtleTogInNhdmVGYWRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzYXZlRmFkZSh0eXBlLCBzaGFwZSwgc3RhcnQsIGVuZCkgewogICAgICB2YXIgaWQgPSB1dWlkdjQoKTsKICAgICAgdGhpcy5mYWRlc1tpZF0gPSB7CiAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICBzaGFwZTogc2hhcGUsCiAgICAgICAgc3RhcnQ6IHN0YXJ0LAogICAgICAgIGVuZDogZW5kCiAgICAgIH07CiAgICAgIHJldHVybiBpZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVGYWRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVGYWRlKGlkKSB7CiAgICAgIGRlbGV0ZSB0aGlzLmZhZGVzW2lkXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRCdWZmZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEJ1ZmZlcihidWZmZXIpIHsKICAgICAgdGhpcy5idWZmZXIgPSBidWZmZXI7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0UGVha0RhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBlYWtEYXRhKGRhdGEpIHsKICAgICAgdGhpcy5wZWFrRGF0YSA9IGRhdGE7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2FsY3VsYXRlUGVha3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNhbGN1bGF0ZVBlYWtzKHNhbXBsZXNQZXJQaXhlbCwgc2FtcGxlUmF0ZSkgewogICAgICB2YXIgY3VlSW4gPSBzZWNvbmRzVG9TYW1wbGVzKHRoaXMuY3VlSW4sIHNhbXBsZVJhdGUpOwogICAgICB2YXIgY3VlT3V0ID0gc2Vjb25kc1RvU2FtcGxlcyh0aGlzLmN1ZU91dCwgc2FtcGxlUmF0ZSk7CiAgICAgIHRoaXMuc2V0UGVha3MoZXh0cmFjdFBlYWtzKHRoaXMuYnVmZmVyLCBzYW1wbGVzUGVyUGl4ZWwsIHRoaXMucGVha0RhdGEubW9ubywgY3VlSW4sIGN1ZU91dCkpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFBlYWtzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQZWFrcyhwZWFrcykgewogICAgICB0aGlzLnBlYWtzID0gcGVha3M7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0U3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0YXRlKHN0YXRlKSB7CiAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICAgICAgaWYgKHRoaXMuc3RhdGUgJiYgdGhpcy5lbmFibGVkU3RhdGVzW3RoaXMuc3RhdGVdKSB7CiAgICAgICAgdmFyIFN0YXRlQ2xhc3MgPSBzdGF0ZUNsYXNzZXNbdGhpcy5zdGF0ZV07CiAgICAgICAgdGhpcy5zdGF0ZU9iaiA9IG5ldyBTdGF0ZUNsYXNzKHRoaXMpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3RhdGVPYmogPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTdGFydFRpbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0YXJ0VGltZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhcnRUaW1lOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEVuZFRpbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVuZFRpbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLmVuZFRpbWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RHVyYXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldER1cmF0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5kdXJhdGlvbjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc1BsYXlpbmciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzUGxheWluZygpIHsKICAgICAgcmV0dXJuIHRoaXMucGxheW91dC5pc1BsYXlpbmcoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRTaG91bGRQbGF5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTaG91bGRQbGF5KGJvb2wpIHsKICAgICAgdGhpcy5wbGF5b3V0LnNldFNob3VsZFBsYXkoYm9vbCk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0R2FpbkxldmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRHYWluTGV2ZWwobGV2ZWwpIHsKICAgICAgdGhpcy5nYWluID0gbGV2ZWw7CiAgICAgIHRoaXMucGxheW91dC5zZXRWb2x1bWVHYWluTGV2ZWwobGV2ZWwpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldE1hc3RlckdhaW5MZXZlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TWFzdGVyR2FpbkxldmVsKGxldmVsKSB7CiAgICAgIHRoaXMucGxheW91dC5zZXRNYXN0ZXJHYWluTGV2ZWwobGV2ZWwpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFN0ZXJlb1BhblZhbHVlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdGVyZW9QYW5WYWx1ZSh2YWx1ZSkgewogICAgICB0aGlzLnN0ZXJlb1BhbiA9IHZhbHVlOwogICAgICB0aGlzLnBsYXlvdXQuc2V0U3RlcmVvUGFuVmFsdWUodmFsdWUpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEVmZmVjdHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEVmZmVjdHMoZWZmZWN0c0dyYXBoKSB7CiAgICAgIHRoaXMuZWZmZWN0c0dyYXBoID0gZWZmZWN0c0dyYXBoOwogICAgICB0aGlzLnBsYXlvdXQuc2V0RWZmZWN0cyhlZmZlY3RzR3JhcGgpOwogICAgfQoKICAgIC8qDQogICAgICBzdGFydFRpbWUsIGVuZFRpbWUgaW4gc2Vjb25kcyAoZmxvYXQpLg0KICAgICAgc2VnbWVudCBpcyBmb3IgYSBoaWdobGlnaHRlZCBzZWN0aW9uIGluIHRoZSBVSS4NCiAgICAgICAgcmV0dXJucyBhIFByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgd2hlbiB0aGUgQXVkaW9CdWZmZXJTb3VyY2UNCiAgICAgIGlzIGVpdGhlciBzdG9wcGVkIG9yIHBsYXlzIG91dCBuYXR1cmFsbHkuDQogICAgKi8KICB9LCB7CiAgICBrZXk6ICJzY2hlZHVsZVBsYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNjaGVkdWxlUGxheShub3csIHN0YXJ0VGltZSwgZW5kVGltZSwgY29uZmlnKSB7CiAgICAgIHZhciBzdGFydDsKICAgICAgdmFyIGR1cmF0aW9uOwogICAgICB2YXIgd2hlbiA9IG5vdzsKICAgICAgdmFyIHNlZ21lbnQgPSBlbmRUaW1lID8gZW5kVGltZSAtIHN0YXJ0VGltZSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIGRlZmF1bHRPcHRpb25zID0gewogICAgICAgIHNob3VsZFBsYXk6IHRydWUsCiAgICAgICAgbWFzdGVyR2FpbjogMSwKICAgICAgICBpc09mZmxpbmU6IGZhbHNlCiAgICAgIH07CiAgICAgIHZhciBvcHRpb25zID0gX2Fzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMsIGNvbmZpZyk7CiAgICAgIHZhciBwbGF5b3V0U3lzdGVtID0gb3B0aW9ucy5pc09mZmxpbmUgPyB0aGlzLm9mZmxpbmVQbGF5b3V0IDogdGhpcy5wbGF5b3V0OwoKICAgICAgLy8gMSkgdHJhY2sgaGFzIG5vIGNvbnRlbnQgdG8gcGxheS4KICAgICAgLy8gMikgdHJhY2sgZG9lcyBub3QgcGxheSBpbiB0aGlzIHNlbGVjdGlvbi4KICAgICAgaWYgKHRoaXMuZW5kVGltZSA8PSBzdGFydFRpbWUgfHwgc2VnbWVudCAmJiBzdGFydFRpbWUgKyBzZWdtZW50IDwgdGhpcy5zdGFydFRpbWUpIHsKICAgICAgICAvLyByZXR1cm4gYSByZXNvbHZlZCBwcm9taXNlIHNpbmNlIHRoaXMgdHJhY2sgaXMgdGVjaG5pY2FsbHkgInN0b3BwZWQiLgogICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgfQoKICAgICAgLy8gdHJhY2sgc2hvdWxkIGhhdmUgc29tZXRoaW5nIHRvIHBsYXkgaWYgaXQgZ2V0cyBoZXJlLgoKICAgICAgLy8gdGhlIHRyYWNrIHN0YXJ0cyBpbiB0aGUgZnV0dXJlIG9yIG9uIHRoZSBjdXJzb3IgcG9zaXRpb24KICAgICAgaWYgKHRoaXMuc3RhcnRUaW1lID49IHN0YXJ0VGltZSkgewogICAgICAgIHN0YXJ0ID0gMDsKICAgICAgICAvLyBzY2hlZHVsZSBhZGRpdGlvbmFsIGRlbGF5IGZvciB0aGlzIGF1ZGlvIG5vZGUuCiAgICAgICAgd2hlbiArPSB0aGlzLnN0YXJ0VGltZSAtIHN0YXJ0VGltZTsKICAgICAgICBpZiAoZW5kVGltZSkgewogICAgICAgICAgc2VnbWVudCAtPSB0aGlzLnN0YXJ0VGltZSAtIHN0YXJ0VGltZTsKICAgICAgICAgIGR1cmF0aW9uID0gTWF0aC5taW4oc2VnbWVudCwgdGhpcy5kdXJhdGlvbik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGR1cmF0aW9uID0gdGhpcy5kdXJhdGlvbjsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhcnQgPSBzdGFydFRpbWUgLSB0aGlzLnN0YXJ0VGltZTsKICAgICAgICBpZiAoZW5kVGltZSkgewogICAgICAgICAgZHVyYXRpb24gPSBNYXRoLm1pbihzZWdtZW50LCB0aGlzLmR1cmF0aW9uIC0gc3RhcnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkdXJhdGlvbiA9IHRoaXMuZHVyYXRpb24gLSBzdGFydDsKICAgICAgICB9CiAgICAgIH0KICAgICAgc3RhcnQgKz0gdGhpcy5jdWVJbjsKICAgICAgdmFyIHJlbFBvcyA9IHN0YXJ0VGltZSAtIHRoaXMuc3RhcnRUaW1lOwogICAgICB2YXIgc291cmNlUHJvbWlzZSA9IHBsYXlvdXRTeXN0ZW0uc2V0VXBTb3VyY2UoKTsKCiAgICAgIC8vIHBhcmFtIHJlbFBvczogY3Vyc29yIHBvc2l0aW9uIGluIHNlY29uZHMgcmVsYXRpdmUgdG8gdGhpcyB0cmFjay4KICAgICAgLy8gY2FuIGJlIG5lZ2F0aXZlIGlmIHRoZSBjdXJzb3IgaXMgcGxhY2VkIGJlZm9yZSB0aGUgc3RhcnQgb2YgdGhpcyB0cmFjayBldGMuCiAgICAgIF9mb3JPd24odGhpcy5mYWRlcywgZnVuY3Rpb24gKGZhZGUpIHsKICAgICAgICB2YXIgZmFkZVN0YXJ0OwogICAgICAgIHZhciBmYWRlRHVyYXRpb247CgogICAgICAgIC8vIG9ubHkgYXBwbHkgZmFkZSBpZiBpdCdzIGFoZWFkIG9mIHRoZSBjdXJzb3IuCiAgICAgICAgaWYgKHJlbFBvcyA8IGZhZGUuZW5kKSB7CiAgICAgICAgICBpZiAocmVsUG9zIDw9IGZhZGUuc3RhcnQpIHsKICAgICAgICAgICAgZmFkZVN0YXJ0ID0gbm93ICsgKGZhZGUuc3RhcnQgLSByZWxQb3MpOwogICAgICAgICAgICBmYWRlRHVyYXRpb24gPSBmYWRlLmVuZCAtIGZhZGUuc3RhcnQ7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlbFBvcyA+IGZhZGUuc3RhcnQgJiYgcmVsUG9zIDwgZmFkZS5lbmQpIHsKICAgICAgICAgICAgZmFkZVN0YXJ0ID0gbm93IC0gKHJlbFBvcyAtIGZhZGUuc3RhcnQpOwogICAgICAgICAgICBmYWRlRHVyYXRpb24gPSBmYWRlLmVuZCAtIGZhZGUuc3RhcnQ7CiAgICAgICAgICB9CiAgICAgICAgICBzd2l0Y2ggKGZhZGUudHlwZSkgewogICAgICAgICAgICBjYXNlIEZBREVJTjoKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwbGF5b3V0U3lzdGVtLmFwcGx5RmFkZUluKGZhZGVTdGFydCwgZmFkZUR1cmF0aW9uLCBmYWRlLnNoYXBlKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSBGQURFT1VUOgogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBsYXlvdXRTeXN0ZW0uYXBwbHlGYWRlT3V0KGZhZGVTdGFydCwgZmFkZUR1cmF0aW9uLCBmYWRlLnNoYXBlKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgZmFkZSB0eXBlIHNhdmVkIG9uIHRyYWNrLiIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBwbGF5b3V0U3lzdGVtLnNldFZvbHVtZUdhaW5MZXZlbCh0aGlzLmdhaW4pOwogICAgICBwbGF5b3V0U3lzdGVtLnNldFNob3VsZFBsYXkob3B0aW9ucy5zaG91bGRQbGF5KTsKICAgICAgcGxheW91dFN5c3RlbS5zZXRNYXN0ZXJHYWluTGV2ZWwob3B0aW9ucy5tYXN0ZXJHYWluKTsKICAgICAgcGxheW91dFN5c3RlbS5zZXRTdGVyZW9QYW5WYWx1ZSh0aGlzLnN0ZXJlb1Bhbik7CiAgICAgIHBsYXlvdXRTeXN0ZW0ucGxheSh3aGVuLCBzdGFydCwgZHVyYXRpb24pOwogICAgICByZXR1cm4gc291cmNlUHJvbWlzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzY2hlZHVsZVN0b3AiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNjaGVkdWxlU3RvcCgpIHsKICAgICAgdmFyIHdoZW4gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDA7CiAgICAgIHRoaXMucGxheW91dC5zdG9wKHdoZW4pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlck92ZXJsYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlck92ZXJsYXkoZGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgY2hhbm5lbFBpeGVscyA9IHNlY29uZHNUb1BpeGVscyhkYXRhLnBsYXlsaXN0TGVuZ3RoLCBkYXRhLnJlc29sdXRpb24sIGRhdGEuc2FtcGxlUmF0ZSk7CiAgICAgIHZhciBjb25maWcgPSB7CiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgc3R5bGU6ICJwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMDsgcmlnaHQ6IDA7IGJvdHRvbTogMDsgbGVmdDogMDsgd2lkdGg6ICIuY29uY2F0KGNoYW5uZWxQaXhlbHMsICJweDsgei1pbmRleDogOTsiKQogICAgICAgIH0KICAgICAgfTsKICAgICAgdmFyIG92ZXJsYXlDbGFzcyA9ICIiOwogICAgICBpZiAodGhpcy5zdGF0ZU9iaikgewogICAgICAgIHRoaXMuc3RhdGVPYmouc2V0dXAoZGF0YS5yZXNvbHV0aW9uLCBkYXRhLnNhbXBsZVJhdGUpOwogICAgICAgIHZhciBTdGF0ZUNsYXNzID0gc3RhdGVDbGFzc2VzW3RoaXMuc3RhdGVdOwogICAgICAgIHZhciBldmVudHMgPSBTdGF0ZUNsYXNzLmdldEV2ZW50cygpOwogICAgICAgIGV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgY29uZmlnWyJvbiIuY29uY2F0KGV2ZW50KV0gPSBfdGhpcy5zdGF0ZU9ialtldmVudF0uYmluZChfdGhpcy5zdGF0ZU9iaik7CiAgICAgICAgfSk7CiAgICAgICAgb3ZlcmxheUNsYXNzID0gU3RhdGVDbGFzcy5nZXRDbGFzcygpOwogICAgICB9CiAgICAgIC8vIHVzZSB0aGlzIG92ZXJsYXkgZm9yIHRyYWNrIGV2ZW50IGN1cnNvciBwb3NpdGlvbiBjYWxjdWxhdGlvbnMuCiAgICAgIHJldHVybiBoKCJkaXYucGxheWxpc3Qtb3ZlcmxheSIuY29uY2F0KG92ZXJsYXlDbGFzcyksIGNvbmZpZyk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyQ29udHJvbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckNvbnRyb2xzKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciBtdXRlQ2xhc3MgPSBkYXRhLm11dGVkID8gIi5hY3RpdmUiIDogIiI7CiAgICAgIHZhciBzb2xvQ2xhc3MgPSBkYXRhLnNvbG9lZCA/ICIuYWN0aXZlIiA6ICIiOwogICAgICB2YXIgaXNDb2xsYXBzZWQgPSBkYXRhLmNvbGxhcHNlZDsKICAgICAgdmFyIG51bUNoYW4gPSB0aGlzLnBlYWtzLmRhdGEubGVuZ3RoOwogICAgICB2YXIgd2lkZ2V0cyA9IGRhdGEuY29udHJvbHMud2lkZ2V0czsKICAgICAgdmFyIHJlbW92ZVRyYWNrID0gaCgiYnV0dG9uLmJ0bi5idG4tZGFuZ2VyLmJ0bi14cy50cmFjay1yZW1vdmUiLCB7CiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgdHlwZTogImJ1dHRvbiIsCiAgICAgICAgICB0aXRsZTogIlJlbW92ZSB0cmFjayIKICAgICAgICB9LAogICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uIG9uY2xpY2soKSB7CiAgICAgICAgICBfdGhpczIuZWUuZW1pdCgicmVtb3ZlVHJhY2siLCBfdGhpczIpOwogICAgICAgIH0KICAgICAgfSwgW2goImkuZmFzLmZhLXRpbWVzIildKTsKCiAgICAgIC8vIGNvbnN0IHRyYWNrTmFtZSA9IGgoInNwYW4iLCBbdGhpcy5uYW1lXSk7CgogICAgICB2YXIgY29sbGFwc2VUcmFjayA9IGgoImJ1dHRvbi5idG4uYnRuLWluZm8uYnRuLXhzLnRyYWNrLWNvbGxhcHNlIiwgewogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHR5cGU6ICJidXR0b24iLAogICAgICAgICAgdGl0bGU6IGlzQ29sbGFwc2VkID8gIkV4cGFuZCB0cmFjayIgOiAiQ29sbGFwc2UgdHJhY2siCiAgICAgICAgfSwKICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbiBvbmNsaWNrKCkgewogICAgICAgICAgX3RoaXMyLmVlLmVtaXQoImNoYW5nZVRyYWNrVmlldyIsIF90aGlzMiwgewogICAgICAgICAgICBjb2xsYXBzZWQ6ICFpc0NvbGxhcHNlZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCBbaCgiaS5mYXMuIi5jb25jYXQoaXNDb2xsYXBzZWQgPyAiZmEtY2FyZXQtZG93biIgOiAiZmEtY2FyZXQtdXAiKSldKTsKICAgICAgdmFyIGhlYWRlckNoaWxkcmVuID0gW107CiAgICAgIGlmICh3aWRnZXRzLnJlbW92ZSkgewogICAgICAgIGhlYWRlckNoaWxkcmVuLnB1c2gocmVtb3ZlVHJhY2spOwogICAgICB9CgogICAgICAvLyBpZiAoIWlzTGVhblRlbXBsYXRlKSBoZWFkZXJDaGlsZHJlbi5wdXNoKHRyYWNrTmFtZSk7CgogICAgICBpZiAod2lkZ2V0cy5jb2xsYXBzZSkgewogICAgICAgIGhlYWRlckNoaWxkcmVuLnB1c2goY29sbGFwc2VUcmFjayk7CiAgICAgIH0KICAgICAgdmFyIHRyYWNrSGVhZGVyQ29udHJvbHMgPSBbaCgiZGl2LnRyYWNrLWhlYWRlci50cmFjay1oZWFkZXItbGVhbiIsIGhlYWRlckNoaWxkcmVuKV07CiAgICAgIHZhciBtdXRlT3JTb2xvQ29udHJvbHMgPSBbXTsKICAgICAgdmFyIHZvbHVtZUNvbnRyb2xzID0gW107CiAgICAgIHZhciBzdGVyZW9QYW5Db250cm9scyA9IFtdOwogICAgICBpZiAoIWlzQ29sbGFwc2VkKSB7CiAgICAgICAgaWYgKHdpZGdldHMubXV0ZU9yU29sbykgewogICAgICAgICAgbXV0ZU9yU29sb0NvbnRyb2xzLnB1c2goaCgiZGl2LmJ0bi1ncm91cC1sZWFuIiwgW2goImJ1dHRvbi5idG4uYnRuLW91dGxpbmUtZGFyay5idG4teHMuYnRuLW11dGUiLmNvbmNhdChtdXRlQ2xhc3MpLCB7CiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgICB0eXBlOiAiYnV0dG9uIgogICAgICAgICAgICB9LAogICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbiBvbmNsaWNrKCkgewogICAgICAgICAgICAgIF90aGlzMi5lZS5lbWl0KCJtdXRlIiwgX3RoaXMyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgWyJNIl0pLCBoKCJidXR0b24uYnRuLmJ0bi1vdXRsaW5lLWRhcmsuYnRuLXhzLmJ0bi1zb2xvIi5jb25jYXQoc29sb0NsYXNzKSwgewogICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbiBvbmNsaWNrKCkgewogICAgICAgICAgICAgIF90aGlzMi5lZS5lbWl0KCJzb2xvIiwgX3RoaXMyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgWyJTIl0pXSkpOwogICAgICAgIH0KICAgICAgICBpZiAod2lkZ2V0cy52b2x1bWUpIHsKICAgICAgICAgIHZvbHVtZUNvbnRyb2xzLnB1c2goaCgibGFiZWwudm9sdW1lLWxlYW4iLCBbaCgnZGl2LnZvbHVtZS1jb250cm9scycsIFtoKCJpLmZhcy5mYS12b2x1bWUtdXAiKV0pLCBoKCJpbnB1dC52b2x1bWUtc2xpZGVyIiwgewogICAgICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICAgICAgImFyaWEtbGFiZWwiOiAiVHJhY2sgdm9sdW1lIGNvbnRyb2wiLAogICAgICAgICAgICAgIHR5cGU6ICJyYW5nZSIsCiAgICAgICAgICAgICAgbWluOiAwLAogICAgICAgICAgICAgIG1heDogMTAwLAogICAgICAgICAgICAgIHZhbHVlOiAxMDAKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaG9vazogbmV3IFZvbHVtZVNsaWRlckhvb2sodGhpcy5nYWluKSwKICAgICAgICAgICAgb25pbnB1dDogZnVuY3Rpb24gb25pbnB1dChlKSB7CiAgICAgICAgICAgICAgX3RoaXMyLmVlLmVtaXQoInZvbHVtZWNoYW5nZSIsIGUudGFyZ2V0LnZhbHVlLCBfdGhpczIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KV0pKTsKICAgICAgICB9CiAgICAgICAgaWYgKHdpZGdldHMuc3RlcmVvUGFuKSB7CiAgICAgICAgICBzdGVyZW9QYW5Db250cm9scy5wdXNoKGgoImxhYmVsLnN0ZXJlb3Bhbi1sZWFuIiwgW2goJ2Rpdi5zdGVyZW9wYW4tY29udHJvbHMnLCBbaCgic3BhbiIsIHt9LCBbIkwiXSksIGgoInNwYW4iLCB7fSwgWyJSIl0pXSksIGgoImlucHV0LnN0ZXJlb3Bhbi1zbGlkZXIiLCB7CiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgICAiYXJpYS1sYWJlbCI6ICJUcmFjayBzdGVyZW8gcGFuIGNvbnRyb2wiLAogICAgICAgICAgICAgIHR5cGU6ICJyYW5nZSIsCiAgICAgICAgICAgICAgbWluOiAtMTAwLAogICAgICAgICAgICAgIG1heDogMTAwLAogICAgICAgICAgICAgIHZhbHVlOiAxMDAKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaG9vazogbmV3IFN0ZXJlb1BhblNsaWRlckhvb2sodGhpcy5zdGVyZW9QYW4pLAogICAgICAgICAgICBvbmlucHV0OiBmdW5jdGlvbiBvbmlucHV0KGUpIHsKICAgICAgICAgICAgICBfdGhpczIuZWUuZW1pdCgic3RlcmVvcGFuIiwgZS50YXJnZXQudmFsdWUgLyAxMDAsIF90aGlzMik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pXSkpOwogICAgICAgIH0KICAgICAgfQogICAgICB2YXIgY29udHJvbHMgPSBbbXV0ZU9yU29sb0NvbnRyb2xzLCB2b2x1bWVDb250cm9scywgc3RlcmVvUGFuQ29udHJvbHMsIHRyYWNrSGVhZGVyQ29udHJvbHNdOwogICAgICByZXR1cm4gaCgiZGl2LmNvbnRyb2xzIiwgewogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHN0eWxlOiAiaGVpZ2h0OiAiLmNvbmNhdChudW1DaGFuICogZGF0YS5oZWlnaHQsICJweDsgd2lkdGg6ICIpLmNvbmNhdChkYXRhLmNvbnRyb2xzLndpZHRoLCAicHg7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogMDsgei1pbmRleDogMTA7IikKICAgICAgICB9CiAgICAgIH0sIGNvbnRyb2xzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcihkYXRhKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICB2YXIgd2lkdGggPSB0aGlzLnBlYWtzLmxlbmd0aDsKICAgICAgdmFyIHBsYXliYWNrWCA9IHNlY29uZHNUb1BpeGVscyhkYXRhLnBsYXliYWNrU2Vjb25kcywgZGF0YS5yZXNvbHV0aW9uLCBkYXRhLnNhbXBsZVJhdGUpOwogICAgICB2YXIgc3RhcnRYID0gc2Vjb25kc1RvUGl4ZWxzKHRoaXMuc3RhcnRUaW1lLCBkYXRhLnJlc29sdXRpb24sIGRhdGEuc2FtcGxlUmF0ZSk7CiAgICAgIHZhciBlbmRYID0gc2Vjb25kc1RvUGl4ZWxzKHRoaXMuZW5kVGltZSwgZGF0YS5yZXNvbHV0aW9uLCBkYXRhLnNhbXBsZVJhdGUpOwogICAgICB2YXIgcHJvZ3Jlc3NXaWR0aCA9IDA7CiAgICAgIHZhciBudW1DaGFuID0gdGhpcy5wZWFrcy5kYXRhLmxlbmd0aDsKICAgICAgdmFyIHNjYWxlID0gTWF0aC5jZWlsKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTsKICAgICAgaWYgKHBsYXliYWNrWCA+IDAgJiYgcGxheWJhY2tYID4gc3RhcnRYKSB7CiAgICAgICAgaWYgKHBsYXliYWNrWCA8IGVuZFgpIHsKICAgICAgICAgIHByb2dyZXNzV2lkdGggPSBwbGF5YmFja1ggLSBzdGFydFg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHByb2dyZXNzV2lkdGggPSB3aWR0aDsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIHdhdmVmb3JtQ2hpbGRyZW4gPSBbaCgiZGl2LmN1cnNvciIsIHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBzdHlsZTogInBvc2l0aW9uOiBhYnNvbHV0ZTsgd2lkdGg6IDFweDsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyB0b3A6IDA7IGxlZnQ6ICIuY29uY2F0KHBsYXliYWNrWCwgInB4OyBib3R0b206IDA7IHotaW5kZXg6IDU7IikKICAgICAgICB9CiAgICAgIH0pXTsKICAgICAgdmFyIGNoYW5uZWxzID0gT2JqZWN0LmtleXModGhpcy5wZWFrcy5kYXRhKS5tYXAoZnVuY3Rpb24gKGNoYW5uZWxOdW0pIHsKICAgICAgICB2YXIgY2hhbm5lbENoaWxkcmVuID0gW2goImRpdi5jaGFubmVsLXByb2dyZXNzIiwgewogICAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgICBzdHlsZTogInBvc2l0aW9uOiBhYnNvbHV0ZTsgd2lkdGg6ICIuY29uY2F0KHByb2dyZXNzV2lkdGgsICJweDsgaGVpZ2h0OiAiKS5jb25jYXQoZGF0YS5oZWlnaHQsICJweDsgei1pbmRleDogMjsiKQogICAgICAgICAgfQogICAgICAgIH0pXTsKICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKICAgICAgICB2YXIgdG90YWxXaWR0aCA9IHdpZHRoOwogICAgICAgIHZhciBwZWFrcyA9IF90aGlzMy5wZWFrcy5kYXRhW2NoYW5uZWxOdW1dOwogICAgICAgIHdoaWxlICh0b3RhbFdpZHRoID4gMCkgewogICAgICAgICAgdmFyIGN1cnJlbnRXaWR0aCA9IE1hdGgubWluKHRvdGFsV2lkdGgsIE1BWF9DQU5WQVNfV0lEVEgpOwogICAgICAgICAgdmFyIGNhbnZhc0NvbG9yID0gX3RoaXMzLndhdmVPdXRsaW5lQ29sb3IgPyBfdGhpczMud2F2ZU91dGxpbmVDb2xvciA6IGRhdGEuY29sb3JzLndhdmVPdXRsaW5lQ29sb3I7CiAgICAgICAgICBjaGFubmVsQ2hpbGRyZW4ucHVzaChoKCJjYW52YXMiLCB7CiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgICB3aWR0aDogY3VycmVudFdpZHRoICogc2NhbGUsCiAgICAgICAgICAgICAgaGVpZ2h0OiBkYXRhLmhlaWdodCAqIHNjYWxlLAogICAgICAgICAgICAgIHN0eWxlOiAiZmxvYXQ6IGxlZnQ7IHBvc2l0aW9uOiByZWxhdGl2ZTsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyB6LWluZGV4OiAzOyB3aWR0aDogIi5jb25jYXQoY3VycmVudFdpZHRoLCAicHg7IGhlaWdodDogIikuY29uY2F0KGRhdGEuaGVpZ2h0LCAicHg7IikKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaG9vazogbmV3IENhbnZhc0hvb2socGVha3MsIG9mZnNldCwgX3RoaXMzLnBlYWtzLmJpdHMsIGNhbnZhc0NvbG9yLCBzY2FsZSwgZGF0YS5oZWlnaHQsIGRhdGEuYmFyV2lkdGgsIGRhdGEuYmFyR2FwKQogICAgICAgICAgfSkpOwogICAgICAgICAgdG90YWxXaWR0aCAtPSBjdXJyZW50V2lkdGg7CiAgICAgICAgICBvZmZzZXQgKz0gTUFYX0NBTlZBU19XSURUSDsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHRoZXJlIGFyZSBmYWRlcywgZGlzcGxheSB0aGVtLgogICAgICAgIGlmIChfdGhpczMuZmFkZUluKSB7CiAgICAgICAgICB2YXIgZmFkZUluID0gX3RoaXMzLmZhZGVzW190aGlzMy5mYWRlSW5dOwogICAgICAgICAgdmFyIGZhZGVXaWR0aCA9IHNlY29uZHNUb1BpeGVscyhmYWRlSW4uZW5kIC0gZmFkZUluLnN0YXJ0LCBkYXRhLnJlc29sdXRpb24sIGRhdGEuc2FtcGxlUmF0ZSk7CiAgICAgICAgICBjaGFubmVsQ2hpbGRyZW4ucHVzaChoKCJkaXYud3AtZmFkZS53cC1mYWRlaW4iLCB7CiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgICBzdHlsZTogInBvc2l0aW9uOiBhYnNvbHV0ZTsgaGVpZ2h0OiAiLmNvbmNhdChkYXRhLmhlaWdodCwgInB4OyB3aWR0aDogIikuY29uY2F0KGZhZGVXaWR0aCwgInB4OyB0b3A6IDA7IGxlZnQ6IDA7IHotaW5kZXg6IDQ7IikKICAgICAgICAgICAgfQogICAgICAgICAgfSwgW2goImNhbnZhcyIsIHsKICAgICAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgICAgIHdpZHRoOiBmYWRlV2lkdGgsCiAgICAgICAgICAgICAgaGVpZ2h0OiBkYXRhLmhlaWdodAogICAgICAgICAgICB9LAogICAgICAgICAgICBob29rOiBuZXcgRmFkZUNhbnZhc0hvb2soZmFkZUluLnR5cGUsIGZhZGVJbi5zaGFwZSwgZmFkZUluLmVuZCAtIGZhZGVJbi5zdGFydCwgZGF0YS5yZXNvbHV0aW9uKQogICAgICAgICAgfSldKSk7CiAgICAgICAgfQogICAgICAgIGlmIChfdGhpczMuZmFkZU91dCkgewogICAgICAgICAgdmFyIGZhZGVPdXQgPSBfdGhpczMuZmFkZXNbX3RoaXMzLmZhZGVPdXRdOwogICAgICAgICAgdmFyIF9mYWRlV2lkdGggPSBzZWNvbmRzVG9QaXhlbHMoZmFkZU91dC5lbmQgLSBmYWRlT3V0LnN0YXJ0LCBkYXRhLnJlc29sdXRpb24sIGRhdGEuc2FtcGxlUmF0ZSk7CiAgICAgICAgICBjaGFubmVsQ2hpbGRyZW4ucHVzaChoKCJkaXYud3AtZmFkZS53cC1mYWRlb3V0IiwgewogICAgICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICAgICAgc3R5bGU6ICJwb3NpdGlvbjogYWJzb2x1dGU7IGhlaWdodDogIi5jb25jYXQoZGF0YS5oZWlnaHQsICJweDsgd2lkdGg6ICIpLmNvbmNhdChfZmFkZVdpZHRoLCAicHg7IHRvcDogMDsgcmlnaHQ6IDA7IHotaW5kZXg6IDQ7IikKICAgICAgICAgICAgfQogICAgICAgICAgfSwgW2goImNhbnZhcyIsIHsKICAgICAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgICAgIHdpZHRoOiBfZmFkZVdpZHRoLAogICAgICAgICAgICAgIGhlaWdodDogZGF0YS5oZWlnaHQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaG9vazogbmV3IEZhZGVDYW52YXNIb29rKGZhZGVPdXQudHlwZSwgZmFkZU91dC5zaGFwZSwgZmFkZU91dC5lbmQgLSBmYWRlT3V0LnN0YXJ0LCBkYXRhLnJlc29sdXRpb24pCiAgICAgICAgICB9KV0pKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGgoImRpdi5jaGFubmVsLmNoYW5uZWwtIi5jb25jYXQoY2hhbm5lbE51bSksIHsKICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgc3R5bGU6ICJoZWlnaHQ6ICIuY29uY2F0KGRhdGEuaGVpZ2h0LCAicHg7IHdpZHRoOiAiKS5jb25jYXQod2lkdGgsICJweDsgdG9wOiAiKS5jb25jYXQoY2hhbm5lbE51bSAqIGRhdGEuaGVpZ2h0LCAicHg7IGxlZnQ6ICIpLmNvbmNhdChzdGFydFgsICJweDsgcG9zaXRpb246IGFic29sdXRlOyBtYXJnaW46IDA7IHBhZGRpbmc6IDA7IHotaW5kZXg6IDE7IikKICAgICAgICAgIH0KICAgICAgICB9LCBjaGFubmVsQ2hpbGRyZW4pOwogICAgICB9KTsKICAgICAgd2F2ZWZvcm1DaGlsZHJlbi5wdXNoKGNoYW5uZWxzKTsKICAgICAgd2F2ZWZvcm1DaGlsZHJlbi5wdXNoKHRoaXMucmVuZGVyT3ZlcmxheShkYXRhKSk7CgogICAgICAvLyBkcmF3IGN1cnNvciBzZWxlY3Rpb24gb24gYWN0aXZlIHRyYWNrLgogICAgICBpZiAoZGF0YS5pc0FjdGl2ZSA9PT0gdHJ1ZSkgewogICAgICAgIHZhciBjU3RhcnRYID0gc2Vjb25kc1RvUGl4ZWxzKGRhdGEudGltZVNlbGVjdGlvbi5zdGFydCwgZGF0YS5yZXNvbHV0aW9uLCBkYXRhLnNhbXBsZVJhdGUpOwogICAgICAgIHZhciBjRW5kWCA9IHNlY29uZHNUb1BpeGVscyhkYXRhLnRpbWVTZWxlY3Rpb24uZW5kLCBkYXRhLnJlc29sdXRpb24sIGRhdGEuc2FtcGxlUmF0ZSk7CiAgICAgICAgdmFyIGNXaWR0aCA9IGNFbmRYIC0gY1N0YXJ0WCArIDE7CiAgICAgICAgdmFyIGNDbGFzc05hbWUgPSBjV2lkdGggPiAxID8gIi5zZWdtZW50IiA6ICIucG9pbnQiOwogICAgICAgIHdhdmVmb3JtQ2hpbGRyZW4ucHVzaChoKCJkaXYuc2VsZWN0aW9uIi5jb25jYXQoY0NsYXNzTmFtZSksIHsKICAgICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgICAgc3R5bGU6ICJwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAiLmNvbmNhdChjV2lkdGgsICJweDsgYm90dG9tOiAwOyB0b3A6IDA7IGxlZnQ6ICIpLmNvbmNhdChjU3RhcnRYLCAicHg7IHotaW5kZXg6IDQ7IikKICAgICAgICAgIH0KICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgdmFyIHdhdmVmb3JtID0gaCgiZGl2LndhdmVmb3JtIiwgewogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHN0eWxlOiAiaGVpZ2h0OiAiLmNvbmNhdChudW1DaGFuICogZGF0YS5oZWlnaHQsICJweDsgcG9zaXRpb246IHJlbGF0aXZlOyIpCiAgICAgICAgfQogICAgICB9LCB3YXZlZm9ybUNoaWxkcmVuKTsKICAgICAgdmFyIGNoYW5uZWxDaGlsZHJlbiA9IFtdOwogICAgICB2YXIgY2hhbm5lbE1hcmdpbiA9IDA7CiAgICAgIGlmIChkYXRhLmNvbnRyb2xzLnNob3cpIHsKICAgICAgICBjaGFubmVsQ2hpbGRyZW4ucHVzaCh0aGlzLnJlbmRlckNvbnRyb2xzKGRhdGEpKTsKICAgICAgICBjaGFubmVsTWFyZ2luID0gZGF0YS5jb250cm9scy53aWR0aDsKICAgICAgfQogICAgICBjaGFubmVsQ2hpbGRyZW4ucHVzaCh3YXZlZm9ybSk7CiAgICAgIHZhciBhdWRpYmxlQ2xhc3MgPSBkYXRhLnNob3VsZFBsYXkgPyAiIiA6ICIuc2lsZW50IjsKICAgICAgdmFyIGN1c3RvbUNsYXNzID0gdGhpcy5jdXN0b21DbGFzcyA9PT0gdW5kZWZpbmVkID8gIiIgOiAiLiIuY29uY2F0KHRoaXMuY3VzdG9tQ2xhc3MpOwogICAgICByZXR1cm4gaCgiZGl2LmNoYW5uZWwtd3JhcHBlciIuY29uY2F0KGF1ZGlibGVDbGFzcykuY29uY2F0KGN1c3RvbUNsYXNzKSwgewogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIHN0eWxlOiAibWFyZ2luLWxlZnQ6ICIuY29uY2F0KGNoYW5uZWxNYXJnaW4sICJweDsgaGVpZ2h0OiAiKS5jb25jYXQoZGF0YS5oZWlnaHQgKiBudW1DaGFuLCAicHg7IikKICAgICAgICB9CiAgICAgIH0sIGNoYW5uZWxDaGlsZHJlbik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VHJhY2tEZXRhaWxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUcmFja0RldGFpbHMoKSB7CiAgICAgIHZhciBpbmZvID0gewogICAgICAgIHNyYzogdGhpcy5zcmMsCiAgICAgICAgc3RhcnQ6IHRoaXMuc3RhcnRUaW1lLAogICAgICAgIGVuZDogdGhpcy5lbmRUaW1lLAogICAgICAgIG5hbWU6IHRoaXMubmFtZSwKICAgICAgICBjdXN0b21DbGFzczogdGhpcy5jdXN0b21DbGFzcywKICAgICAgICBjdWVpbjogdGhpcy5jdWVJbiwKICAgICAgICBjdWVvdXQ6IHRoaXMuY3VlT3V0LAogICAgICAgIHN0ZXJlb1BhbjogdGhpcy5zdGVyZW9QYW4sCiAgICAgICAgZ2FpbjogdGhpcy5nYWluLAogICAgICAgIGVmZmVjdHM6IHRoaXMuZWZmZWN0c0dyYXBoCiAgICAgIH07CiAgICAgIGlmICh0aGlzLmZhZGVJbikgewogICAgICAgIHZhciBmYWRlSW4gPSB0aGlzLmZhZGVzW3RoaXMuZmFkZUluXTsKICAgICAgICBpbmZvLmZhZGVJbiA9IHsKICAgICAgICAgIHNoYXBlOiBmYWRlSW4uc2hhcGUsCiAgICAgICAgICBkdXJhdGlvbjogZmFkZUluLmVuZCAtIGZhZGVJbi5zdGFydAogICAgICAgIH07CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZmFkZU91dCkgewogICAgICAgIHZhciBmYWRlT3V0ID0gdGhpcy5mYWRlc1t0aGlzLmZhZGVPdXRdOwogICAgICAgIGluZm8uZmFkZU91dCA9IHsKICAgICAgICAgIHNoYXBlOiBmYWRlT3V0LnNoYXBlLAogICAgICAgICAgZHVyYXRpb246IGZhZGVPdXQuZW5kIC0gZmFkZU91dC5zdGFydAogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIGluZm87CiAgICB9CiAgfV0pOwp9KCk7CmV4cG9ydCB7IF9kZWZhdWx0IGFzIGRlZmF1bHQgfTs="},{"version":3,"names":["_assign","_forOwn","v4","uuidv4","h","extractPeaks","FADEIN","FADEOUT","secondsToPixels","secondsToSamples","stateClasses","CanvasHook","FadeCanvasHook","VolumeSliderHook","StereoPanSliderHook","MAX_CANVAS_WIDTH","_default","_classCallCheck","name","customClass","undefined","waveOutlineColor","gain","fades","peakData","type","mono","cueIn","cueOut","duration","startTime","endTime","stereoPan","hertzjsTrack","_createClass","key","value","setHertzjsTrack","hertjzTrack","setEventEmitter","ee","setName","setCustomClass","className","setWaveOutlineColor","color","setCues","Error","trim","start","end","trackStart","getStartTime","trackEnd","getEndTime","offset","setStartTime","createArrayBuffer","point1","point2","audioContext","newArrayBuffer","timeSplitOffset","firstPartPercentage","secondTimeSplitOffset","secondPartPercentage","channels","buffer","numberOfChannels","firstPartNewLength","length","secondPartNewLength","createBuffer","sampleRate","arrayFirstPart","Float32Array","arraySecondPart","channel","copyFromChannel","copyToChannel","razorCut","point","track","newArrayBuffer1","newArrayBuffer2","razorCutObject","Track","Point","buffer1","buffer2","emit","removePart","new_cueIn","new_cueOut","buffer_duration","console","log","Object","keys","fadeInDuration","fadeOutDuration","forEach","totalFadesDuration","fadeIn","removeFade","fadeOut","playout","setPlayout","setOfflinePlayout","offlinePlayout","setEnabledStates","enabledStates","arguments","defaultStatesEnabled","cursor","fadein","fadeout","select","shift","setFadeIn","shape","fade","saveFade","setFadeOut","id","setBuffer","setPeakData","data","calculatePeaks","samplesPerPixel","setPeaks","peaks","setState","state","StateClass","stateObj","getDuration","isPlaying","setShouldPlay","bool","setGainLevel","level","setVolumeGainLevel","setMasterGainLevel","setStereoPanValue","setEffects","effectsGraph","schedulePlay","now","config","when","segment","defaultOptions","shouldPlay","masterGain","isOffline","options","playoutSystem","Promise","resolve","Math","min","relPos","sourcePromise","setUpSource","fadeStart","fadeDuration","applyFadeIn","applyFadeOut","play","scheduleStop","stop","renderOverlay","_this","channelPixels","playlistLength","resolution","attributes","style","concat","overlayClass","setup","events","getEvents","event","bind","getClass","renderControls","_this2","muteClass","muted","soloClass","soloed","isCollapsed","collapsed","numChan","widgets","controls","removeTrack","title","onclick","collapseTrack","headerChildren","remove","push","collapse","trackHeaderControls","muteOrSoloControls","volumeControls","stereoPanControls","muteOrSolo","volume","max","hook","oninput","e","target","height","width","render","_this3","playbackX","playbackSeconds","startX","endX","progressWidth","scale","ceil","window","devicePixelRatio","waveformChildren","map","channelNum","channelChildren","totalWidth","currentWidth","canvasColor","colors","bits","barWidth","barGap","fadeWidth","isActive","cStartX","timeSelection","cEndX","cWidth","cClassName","waveform","channelMargin","show","audibleClass","getTrackDetails","info","src","cuein","cueout","effects","default"],"sources":["C:/teste-login/src/Track.js"],"sourcesContent":["import _assign from \"lodash.assign\";\r\nimport _forOwn from \"lodash.forown\";\r\n\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport h from \"virtual-dom/h\";\r\n\r\nimport extractPeaks from \"webaudio-peaks\";\r\nimport { FADEIN, FADEOUT } from \"fade-maker\";\r\n\r\nimport { secondsToPixels, secondsToSamples } from \"./utils/conversions\";\r\nimport stateClasses from \"./track/states\";\r\n\r\nimport CanvasHook from \"./render/CanvasHook\";\r\nimport FadeCanvasHook from \"./render/FadeCanvasHook\";\r\nimport VolumeSliderHook from \"./render/VolumeSliderHook\";\r\nimport StereoPanSliderHook from \"./render/StereoPanSliderHook\";\r\n\r\nconst MAX_CANVAS_WIDTH = 1000;\r\n\r\nexport default class {\r\n  constructor() {\r\n    this.name = \"Untitled\";\r\n    this.customClass = undefined;\r\n    this.waveOutlineColor = undefined;\r\n    this.gain = 1;\r\n    this.fades = {};\r\n    this.peakData = {\r\n      type: \"WebAudio\",\r\n      mono: false,\r\n    };\r\n\r\n    this.cueIn = 0;\r\n    this.cueOut = 0;\r\n    this.duration = 0;\r\n    this.startTime = 0;\r\n    this.endTime = 0;\r\n    this.stereoPan = 0;\r\n    this.hertzjsTrack = undefined;\r\n  }\r\n\r\n  setHertzjsTrack(hertjzTrack) {\r\n    this.hertzjsTrack = hertjzTrack;\r\n  }\r\n\r\n  setEventEmitter(ee) {\r\n    this.ee = ee;\r\n  }\r\n\r\n  setName(name) {\r\n    this.name = name;\r\n  }\r\n\r\n  setCustomClass(className) {\r\n    this.customClass = className;\r\n  }\r\n\r\n  setWaveOutlineColor(color) {\r\n    this.waveOutlineColor = color;\r\n  }\r\n\r\n  setCues(cueIn, cueOut) {\r\n    if (cueOut < cueIn) {\r\n      throw new Error(\"cue out cannot be less than cue in\");\r\n    }\r\n\r\n    this.cueIn = cueIn;\r\n    this.cueOut = cueOut;\r\n    this.duration = this.cueOut - this.cueIn;\r\n    this.endTime = this.startTime + this.duration;\r\n  }\r\n\r\n  /*\r\n   *   start, end in seconds relative to the entire playlist.\r\n   */\r\n  trim(start, end) {\r\n    const trackStart = this.getStartTime();\r\n    const trackEnd = this.getEndTime();\r\n    const offset = this.cueIn - trackStart;\r\n\r\n    if (\r\n      (trackStart <= start && trackEnd >= start) ||\r\n      (trackStart <= end && trackEnd >= end)\r\n    ) {\r\n      const cueIn = start < trackStart ? trackStart : start;\r\n      const cueOut = end > trackEnd ? trackEnd : end;\r\n\r\n      this.setCues(cueIn + offset, cueOut + offset);\r\n      if (start > trackStart) {\r\n        this.setStartTime(start);\r\n      }\r\n    }\r\n  }\r\n\r\n  createArrayBuffer(point1, point2, audioContext) {\r\n    let newArrayBuffer;\r\n    const trackStart = this.getStartTime();\r\n    const trackEnd = this.getEndTime();\r\n  \r\n    let start = point1;\r\n    let end = point2;\r\n  \r\n    let timeSplitOffset = start - this.getStartTime();\r\n    if (timeSplitOffset < 0) {\r\n      // outside interval left\r\n      timeSplitOffset = 0;\r\n    }\r\n    const firstPartPercentage = timeSplitOffset / this.duration;\r\n  \r\n    const secondTimeSplitOffset = end - this.getStartTime();\r\n    let secondPartPercentage =\r\n      (this.duration - secondTimeSplitOffset) / this.duration;\r\n    if (secondPartPercentage < 0) {\r\n      // outside interval right\r\n      secondPartPercentage = 0;\r\n    }\r\n  \r\n    if (start <= trackEnd && end >= trackStart) {\r\n      const channels = this.buffer.numberOfChannels;\r\n      const firstPartNewLength = firstPartPercentage * this.buffer.length;\r\n      const secondPartNewLength = secondPartPercentage * this.buffer.length;\r\n      \r\n      newArrayBuffer = audioContext.createBuffer(\r\n        channels,\r\n        firstPartNewLength + secondPartNewLength,\r\n        this.buffer.sampleRate\r\n      );\r\n      const arrayFirstPart = new Float32Array(firstPartNewLength);\r\n      const arraySecondPart = new Float32Array(secondPartNewLength);\r\n  \r\n      for (let channel = 0; channel < channels; channel++) {\r\n        this.buffer.copyFromChannel(arrayFirstPart, channel, 0);\r\n        this.buffer.copyFromChannel(\r\n          arraySecondPart,\r\n          channel,\r\n          this.buffer.length - secondPartNewLength\r\n        );\r\n        newArrayBuffer.copyToChannel(arrayFirstPart, channel, 0);\r\n        newArrayBuffer.copyToChannel(\r\n          arraySecondPart,\r\n          channel,\r\n          firstPartNewLength\r\n        );\r\n      }\r\n    }\r\n    return newArrayBuffer;\r\n  }\r\n\r\n  razorCut(point, audioContext, track) {\r\n    const newArrayBuffer1 = this.createArrayBuffer(\r\n      point,\r\n      track.endTime,\r\n      audioContext\r\n    );\r\n    const newArrayBuffer2 = this.createArrayBuffer(\r\n      track.startTime,\r\n      point,\r\n      audioContext\r\n    );\r\n    let razorCutObject = {\r\n      Track: track,\r\n      Point: point,\r\n      buffer1: newArrayBuffer1,\r\n      buffer2: newArrayBuffer2,\r\n    };\r\n    return this.ee.emit(\"razorCutFinished\", razorCutObject);\r\n  }\r\n\r\n  removePart(point1, point2, audioContext, track) {\r\n    this.ee.emit(\"saveCutManipulation\", this.buffer, track);\r\n\r\n    const trackStart = this.getStartTime();\r\n    const trackEnd = this.getEndTime();\r\n\r\n    let start;\r\n    let end;\r\n    if (point1 <= point2) {\r\n      start = point1;\r\n      end = point2;\r\n    } else {\r\n      start = point2;\r\n      end = point1;\r\n    }\r\n\r\n    if (start <= trackStart) {\r\n      start = trackStart;\r\n    }\r\n    if (end >= trackEnd) {\r\n      end = trackEnd;\r\n    }\r\n\r\n    let new_cueIn = this.cueIn;\r\n    let new_cueOut = this.cueOut - (end - start);\r\n\r\n    let buffer_duration = (this.buffer.length * 2) / (this.buffer.sampleRate * this.buffer.numberOfChannels);\r\n\r\n    let timeSplitOffset = start - this.getStartTime() + this.cueIn;\r\n    console.log(\"timeSplitOffset: \" + timeSplitOffset);\r\n\r\n    if (timeSplitOffset < 0) {\r\n      // outside interval left\r\n      timeSplitOffset = 0;\r\n    }\r\n    const firstPartPercentage = timeSplitOffset / buffer_duration;\r\n\r\n    const secondTimeSplitOffset = end - this.getStartTime() + this.cueIn;\r\n    let secondPartPercentage =\r\n      (buffer_duration - secondTimeSplitOffset) / buffer_duration;\r\n    if (secondPartPercentage < 0) {\r\n      // outside interval right\r\n      secondPartPercentage = 0;\r\n    }\r\n\r\n    if (start <= trackEnd && end >= trackStart) {\r\n      const channels = this.buffer.numberOfChannels;\r\n\r\n      let newArrayBuffer;\r\n      const firstPartNewLength = firstPartPercentage * this.buffer.length;\r\n      const secondPartNewLength = secondPartPercentage * this.buffer.length;\r\n\r\n      newArrayBuffer = audioContext.createBuffer(\r\n        channels,\r\n        firstPartNewLength + secondPartNewLength,\r\n        this.buffer.sampleRate\r\n      );\r\n      const arrayFirstPart = new Float32Array(firstPartNewLength);\r\n      const arraySecondPart = new Float32Array(secondPartNewLength);\r\n\r\n      for (let channel = 0; channel < channels; channel++) {\r\n        this.buffer.copyFromChannel(arrayFirstPart, channel, 0);\r\n        this.buffer.copyFromChannel(\r\n          arraySecondPart,\r\n          channel,\r\n          this.buffer.length - secondPartNewLength\r\n        );\r\n        newArrayBuffer.copyToChannel(arrayFirstPart, channel, 0);\r\n        newArrayBuffer.copyToChannel(\r\n          arraySecondPart,\r\n          channel,\r\n          firstPartNewLength\r\n        );\r\n      }\r\n\r\n      let fades = track.fades;\r\n      if (typeof fades !== \"undefined\" && Object.keys(fades).length > 0) {\r\n        let fadeInDuration = 0,\r\n          fadeOutDuration = 0;\r\n        Object.keys(fades).forEach((key) => {\r\n          if (fades[key].type === \"FadeIn\") {\r\n            fadeInDuration = fades[key].end - fades[key].start;\r\n          } else if (fades[key].type === \"FadeOut\") {\r\n            fadeOutDuration = fades[key].end - fades[key].start;\r\n          }\r\n        });\r\n        let totalFadesDuration = fadeInDuration + fadeOutDuration;\r\n        if (totalFadesDuration >= newArrayBuffer.duration) {\r\n          // Only remove fades if they will intersect or be longer than new arrayBuffer after cut\r\n          if (this.fadeIn) {\r\n            this.removeFade(this.fadeIn);\r\n            this.fadeIn = undefined;\r\n          }\r\n          if (this.fadeOut) {\r\n            this.removeFade(this.fadeOut);\r\n            this.fadeOut = undefined;\r\n          }\r\n        }\r\n      }\r\n\r\n      this.buffer = newArrayBuffer;\r\n      this.setCues(new_cueIn, new_cueOut);\r\n      this.playout.buffer = this.buffer;\r\n    }\r\n  }\r\n\r\n\r\n  setStartTime(start) {\r\n    this.startTime = start;\r\n    this.endTime = start + this.duration;\r\n  }\r\n\r\n  setPlayout(playout) {\r\n    this.playout = playout;\r\n  }\r\n\r\n  setOfflinePlayout(playout) {\r\n    this.offlinePlayout = playout;\r\n  }\r\n\r\n  setEnabledStates(enabledStates = {}) {\r\n    const defaultStatesEnabled = {\r\n      cursor: true,\r\n      fadein: true,\r\n      fadeout: true,\r\n      select: true,\r\n      shift: true,\r\n    };\r\n\r\n    this.enabledStates = _assign({}, defaultStatesEnabled, enabledStates);\r\n  }\r\n\r\n  setFadeIn(duration, shape = \"logarithmic\") {\r\n    if (duration > this.duration) {\r\n      throw new Error(\"Invalid Fade In\");\r\n    }\r\n\r\n    const fade = {\r\n      shape,\r\n      start: 0,\r\n      end: duration,\r\n    };\r\n\r\n    if (this.fadeIn) {\r\n      this.removeFade(this.fadeIn);\r\n      this.fadeIn = undefined;\r\n    }\r\n\r\n    this.fadeIn = this.saveFade(FADEIN, fade.shape, fade.start, fade.end);\r\n  }\r\n\r\n  setFadeOut(duration, shape = \"logarithmic\") {\r\n    if (duration > this.duration) {\r\n      throw new Error(\"Invalid Fade Out\");\r\n    }\r\n\r\n    const fade = {\r\n      shape,\r\n      start: this.duration - duration,\r\n      end: this.duration,\r\n    };\r\n\r\n    if (this.fadeOut) {\r\n      this.removeFade(this.fadeOut);\r\n      this.fadeOut = undefined;\r\n    }\r\n\r\n    this.fadeOut = this.saveFade(FADEOUT, fade.shape, fade.start, fade.end);\r\n  }\r\n\r\n  saveFade(type, shape, start, end) {\r\n    const id = uuidv4();\r\n\r\n    this.fades[id] = {\r\n      type,\r\n      shape,\r\n      start,\r\n      end,\r\n    };\r\n\r\n    return id;\r\n  }\r\n\r\n  removeFade(id) {\r\n    delete this.fades[id];\r\n  }\r\n\r\n  setBuffer(buffer) {\r\n    this.buffer = buffer;\r\n  }\r\n\r\n  setPeakData(data) {\r\n    this.peakData = data;\r\n  }\r\n\r\n  calculatePeaks(samplesPerPixel, sampleRate) {\r\n    const cueIn = secondsToSamples(this.cueIn, sampleRate);\r\n    const cueOut = secondsToSamples(this.cueOut, sampleRate);\r\n\r\n    this.setPeaks(\r\n      extractPeaks(\r\n        this.buffer,\r\n        samplesPerPixel,\r\n        this.peakData.mono,\r\n        cueIn,\r\n        cueOut\r\n      )\r\n    );\r\n  }\r\n\r\n  setPeaks(peaks) {\r\n    this.peaks = peaks;\r\n  }\r\n\r\n  setState(state) {\r\n    this.state = state;\r\n\r\n    if (this.state && this.enabledStates[this.state]) {\r\n      const StateClass = stateClasses[this.state];\r\n      this.stateObj = new StateClass(this);\r\n    } else {\r\n      this.stateObj = undefined;\r\n    }\r\n  }\r\n\r\n  getStartTime() {\r\n    return this.startTime;\r\n  }\r\n\r\n  getEndTime() {\r\n    return this.endTime;\r\n  }\r\n\r\n  getDuration() {\r\n    return this.duration;\r\n  }\r\n\r\n  isPlaying() {\r\n    return this.playout.isPlaying();\r\n  }\r\n\r\n  setShouldPlay(bool) {\r\n    this.playout.setShouldPlay(bool);\r\n  }\r\n\r\n  setGainLevel(level) {\r\n    this.gain = level;\r\n    this.playout.setVolumeGainLevel(level);\r\n  }\r\n\r\n  setMasterGainLevel(level) {\r\n    this.playout.setMasterGainLevel(level);\r\n  }\r\n\r\n  setStereoPanValue(value) {\r\n    this.stereoPan = value;\r\n    this.playout.setStereoPanValue(value);\r\n  }\r\n\r\n  setEffects(effectsGraph) {\r\n    this.effectsGraph = effectsGraph;\r\n    this.playout.setEffects(effectsGraph);\r\n  }\r\n\r\n  /*\r\n    startTime, endTime in seconds (float).\r\n    segment is for a highlighted section in the UI.\r\n\r\n    returns a Promise that will resolve when the AudioBufferSource\r\n    is either stopped or plays out naturally.\r\n  */\r\n  schedulePlay(now, startTime, endTime, config) {\r\n    let start;\r\n    let duration;\r\n    let when = now;\r\n    let segment = endTime ? endTime - startTime : undefined;\r\n\r\n    const defaultOptions = {\r\n      shouldPlay: true,\r\n      masterGain: 1,\r\n      isOffline: false,\r\n    };\r\n\r\n    const options = _assign({}, defaultOptions, config);\r\n    const playoutSystem = options.isOffline\r\n      ? this.offlinePlayout\r\n      : this.playout;\r\n\r\n    // 1) track has no content to play.\r\n    // 2) track does not play in this selection.\r\n    if (\r\n      this.endTime <= startTime ||\r\n      (segment && startTime + segment < this.startTime)\r\n    ) {\r\n      // return a resolved promise since this track is technically \"stopped\".\r\n      return Promise.resolve();\r\n    }\r\n\r\n    // track should have something to play if it gets here.\r\n\r\n    // the track starts in the future or on the cursor position\r\n    if (this.startTime >= startTime) {\r\n      start = 0;\r\n      // schedule additional delay for this audio node.\r\n      when += this.startTime - startTime;\r\n\r\n      if (endTime) {\r\n        segment -= this.startTime - startTime;\r\n        duration = Math.min(segment, this.duration);\r\n      } else {\r\n        duration = this.duration;\r\n      }\r\n    } else {\r\n      start = startTime - this.startTime;\r\n\r\n      if (endTime) {\r\n        duration = Math.min(segment, this.duration - start);\r\n      } else {\r\n        duration = this.duration - start;\r\n      }\r\n    }\r\n\r\n    start += this.cueIn;\r\n    const relPos = startTime - this.startTime;\r\n    const sourcePromise = playoutSystem.setUpSource();\r\n\r\n    // param relPos: cursor position in seconds relative to this track.\r\n    // can be negative if the cursor is placed before the start of this track etc.\r\n    _forOwn(this.fades, (fade) => {\r\n      let fadeStart;\r\n      let fadeDuration;\r\n\r\n      // only apply fade if it's ahead of the cursor.\r\n      if (relPos < fade.end) {\r\n        if (relPos <= fade.start) {\r\n          fadeStart = now + (fade.start - relPos);\r\n          fadeDuration = fade.end - fade.start;\r\n        } else if (relPos > fade.start && relPos < fade.end) {\r\n          fadeStart = now - (relPos - fade.start);\r\n          fadeDuration = fade.end - fade.start;\r\n        }\r\n\r\n        switch (fade.type) {\r\n          case FADEIN: {\r\n            playoutSystem.applyFadeIn(fadeStart, fadeDuration, fade.shape);\r\n            break;\r\n          }\r\n          case FADEOUT: {\r\n            playoutSystem.applyFadeOut(fadeStart, fadeDuration, fade.shape);\r\n            break;\r\n          }\r\n          default: {\r\n            throw new Error(\"Invalid fade type saved on track.\");\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    playoutSystem.setVolumeGainLevel(this.gain);\r\n    playoutSystem.setShouldPlay(options.shouldPlay);\r\n    playoutSystem.setMasterGainLevel(options.masterGain);\r\n    playoutSystem.setStereoPanValue(this.stereoPan);\r\n    playoutSystem.play(when, start, duration);\r\n\r\n    return sourcePromise;\r\n  }\r\n\r\n  scheduleStop(when = 0) {\r\n    this.playout.stop(when);\r\n  }\r\n\r\n  renderOverlay(data) {\r\n    const channelPixels = secondsToPixels(\r\n      data.playlistLength,\r\n      data.resolution,\r\n      data.sampleRate\r\n    );\r\n\r\n    const config = {\r\n      attributes: {\r\n        style: `position: absolute; top: 0; right: 0; bottom: 0; left: 0; width: ${channelPixels}px; z-index: 9;`,\r\n      },\r\n    };\r\n\r\n    let overlayClass = \"\";\r\n\r\n    if (this.stateObj) {\r\n      this.stateObj.setup(data.resolution, data.sampleRate);\r\n      const StateClass = stateClasses[this.state];\r\n      const events = StateClass.getEvents();\r\n\r\n      events.forEach((event) => {\r\n        config[`on${event}`] = this.stateObj[event].bind(this.stateObj);\r\n      });\r\n\r\n      overlayClass = StateClass.getClass();\r\n    }\r\n    // use this overlay for track event cursor position calculations.\r\n    return h(`div.playlist-overlay${overlayClass}`, config);\r\n  }\r\n\r\n  renderControls(data) {\r\n    const muteClass = data.muted ? \".active\" : \"\";\r\n    const soloClass = data.soloed ? \".active\" : \"\";\r\n    const isCollapsed = data.collapsed;\r\n    const numChan = this.peaks.data.length;\r\n    const widgets = data.controls.widgets;\r\n    \r\n    const removeTrack = h(\r\n      \"button.btn.btn-danger.btn-xs.track-remove\",\r\n      {\r\n        attributes: {\r\n          type: \"button\",\r\n          title: \"Remove track\",\r\n        },\r\n        onclick: () => {\r\n          this.ee.emit(\"removeTrack\", this);\r\n        },\r\n      },\r\n      [h(\"i.fas.fa-times\")]\r\n    );\r\n\r\n    // const trackName = h(\"span\", [this.name]);\r\n\r\n    const collapseTrack = h(\r\n      \"button.btn.btn-info.btn-xs.track-collapse\",\r\n      {\r\n        attributes: {\r\n          type: \"button\",\r\n          title: isCollapsed ? \"Expand track\" : \"Collapse track\",\r\n        },\r\n        onclick: () => {\r\n          this.ee.emit(\"changeTrackView\", this, {\r\n            collapsed: !isCollapsed,\r\n          });\r\n        },\r\n      },\r\n      [h(`i.fas.${isCollapsed ? \"fa-caret-down\" : \"fa-caret-up\"}`)]\r\n    );\r\n\r\n    const headerChildren = [];\r\n\r\n    if (widgets.remove) {\r\n      headerChildren.push(removeTrack);\r\n    }\r\n    \r\n    // if (!isLeanTemplate) headerChildren.push(trackName);\r\n\r\n    if (widgets.collapse) {\r\n      headerChildren.push(collapseTrack);\r\n    }\r\n\r\n    const trackHeaderControls = [h(`div.track-header.track-header-lean`, headerChildren)];\r\n\r\n    const muteOrSoloControls = [];\r\n    const volumeControls = [];\r\n    const stereoPanControls = [];\r\n    if (!isCollapsed) {\r\n      if (widgets.muteOrSolo) {\r\n        muteOrSoloControls.push(\r\n          h(`div.btn-group-lean`, [\r\n            h(\r\n              `button.btn.btn-outline-dark.btn-xs.btn-mute${muteClass}`,\r\n              {\r\n                attributes: {\r\n                  type: \"button\",\r\n                },\r\n                onclick: () => {\r\n                  this.ee.emit(\"mute\", this);\r\n                },\r\n              },\r\n              [\"M\"]\r\n            ),\r\n            h(\r\n              `button.btn.btn-outline-dark.btn-xs.btn-solo${soloClass}`,\r\n              {\r\n                onclick: () => {\r\n                  this.ee.emit(\"solo\", this);\r\n                },\r\n              },\r\n              [\"S\"]\r\n            ),\r\n          ])\r\n        );\r\n      }\r\n      if (widgets.volume) {\r\n        volumeControls.push(\r\n          h(`label.volume-lean`, [\r\n            h('div.volume-controls',[\r\n              h(`i.fas.fa-volume-up`)\r\n          ]),\r\n            h(\"input.volume-slider\", {\r\n              attributes: {\r\n                \"aria-label\": \"Track volume control\",\r\n                type: \"range\",\r\n                min: 0,\r\n                max: 100,\r\n                value: 100,\r\n              },\r\n              hook: new VolumeSliderHook(this.gain),\r\n              oninput: (e) => {\r\n                this.ee.emit(\"volumechange\", e.target.value, this);\r\n              },\r\n            }),\r\n          ])\r\n        );\r\n      }\r\n      if (widgets.stereoPan) {\r\n        stereoPanControls.push(\r\n          h(`label.stereopan-lean`, [\r\n            h('div.stereopan-controls',[\r\n              h(`span`, { }, [\"L\"]),\r\n              h(`span`, { }, [\"R\"]),\r\n          ]),\r\n            h(\"input.stereopan-slider\", {\r\n              attributes: {\r\n                \"aria-label\": \"Track stereo pan control\",\r\n                type: \"range\",\r\n                min: -100,\r\n                max: 100,\r\n                value: 100,\r\n              },\r\n              hook: new StereoPanSliderHook(this.stereoPan),\r\n              oninput: (e) => {\r\n                this.ee.emit(\"stereopan\", e.target.value / 100, this);\r\n              },\r\n            }),\r\n          ])\r\n        );\r\n      }\r\n    }\r\n\r\n    const controls = [muteOrSoloControls, volumeControls, stereoPanControls, trackHeaderControls];\r\n\r\n    return h(\r\n      \"div.controls\",\r\n      {\r\n        attributes: {\r\n          style: `height: ${numChan * data.height}px; width: ${data.controls.width\r\n            }px; position: absolute; left: 0; z-index: 10;`,\r\n        },\r\n      },\r\n      controls\r\n    );\r\n  }\r\n\r\n  render(data) {\r\n    const width = this.peaks.length;\r\n    const playbackX = secondsToPixels(\r\n      data.playbackSeconds,\r\n      data.resolution,\r\n      data.sampleRate\r\n    );\r\n    const startX = secondsToPixels(\r\n      this.startTime,\r\n      data.resolution,\r\n      data.sampleRate\r\n    );\r\n    const endX = secondsToPixels(\r\n      this.endTime,\r\n      data.resolution,\r\n      data.sampleRate\r\n    );\r\n    let progressWidth = 0;\r\n    const numChan = this.peaks.data.length;\r\n    const scale = Math.ceil(window.devicePixelRatio);\r\n\r\n    if (playbackX > 0 && playbackX > startX) {\r\n      if (playbackX < endX) {\r\n        progressWidth = playbackX - startX;\r\n      } else {\r\n        progressWidth = width;\r\n      }\r\n    }\r\n\r\n    const waveformChildren = [\r\n      h(\"div.cursor\", {\r\n        attributes: {\r\n          style: `position: absolute; width: 1px; margin: 0; padding: 0; top: 0; left: ${playbackX}px; bottom: 0; z-index: 5;`,\r\n        },\r\n      }),\r\n    ];\r\n\r\n    const channels = Object.keys(this.peaks.data).map((channelNum) => {\r\n      const channelChildren = [\r\n        h(\"div.channel-progress\", {\r\n          attributes: {\r\n            style: `position: absolute; width: ${progressWidth}px; height: ${data.height}px; z-index: 2;`,\r\n          },\r\n        }),\r\n      ];\r\n      let offset = 0;\r\n      let totalWidth = width;\r\n      const peaks = this.peaks.data[channelNum];\r\n\r\n      while (totalWidth > 0) {\r\n        const currentWidth = Math.min(totalWidth, MAX_CANVAS_WIDTH);\r\n        const canvasColor = this.waveOutlineColor\r\n          ? this.waveOutlineColor\r\n          : data.colors.waveOutlineColor;\r\n\r\n        channelChildren.push(\r\n          h(\"canvas\", {\r\n            attributes: {\r\n              width: currentWidth * scale,\r\n              height: data.height * scale,\r\n              style: `float: left; position: relative; margin: 0; padding: 0; z-index: 3; width: ${currentWidth}px; height: ${data.height}px;`,\r\n            },\r\n            hook: new CanvasHook(\r\n              peaks,\r\n              offset,\r\n              this.peaks.bits,\r\n              canvasColor,\r\n              scale,\r\n              data.height,\r\n              data.barWidth,\r\n              data.barGap\r\n            ),\r\n          })\r\n        );\r\n\r\n        totalWidth -= currentWidth;\r\n        offset += MAX_CANVAS_WIDTH;\r\n      }\r\n\r\n      // if there are fades, display them.\r\n      if (this.fadeIn) {\r\n        const fadeIn = this.fades[this.fadeIn];\r\n        const fadeWidth = secondsToPixels(\r\n          fadeIn.end - fadeIn.start,\r\n          data.resolution,\r\n          data.sampleRate\r\n        );\r\n\r\n        channelChildren.push(\r\n          h(\r\n            \"div.wp-fade.wp-fadein\",\r\n            {\r\n              attributes: {\r\n                style: `position: absolute; height: ${data.height}px; width: ${fadeWidth}px; top: 0; left: 0; z-index: 4;`,\r\n              },\r\n            },\r\n            [\r\n              h(\"canvas\", {\r\n                attributes: {\r\n                  width: fadeWidth,\r\n                  height: data.height,\r\n                },\r\n                hook: new FadeCanvasHook(\r\n                  fadeIn.type,\r\n                  fadeIn.shape,\r\n                  fadeIn.end - fadeIn.start,\r\n                  data.resolution\r\n                ),\r\n              }),\r\n            ]\r\n          )\r\n        );\r\n      }\r\n\r\n      if (this.fadeOut) {\r\n        const fadeOut = this.fades[this.fadeOut];\r\n        const fadeWidth = secondsToPixels(\r\n          fadeOut.end - fadeOut.start,\r\n          data.resolution,\r\n          data.sampleRate\r\n        );\r\n\r\n        channelChildren.push(\r\n          h(\r\n            \"div.wp-fade.wp-fadeout\",\r\n            {\r\n              attributes: {\r\n                style: `position: absolute; height: ${data.height}px; width: ${fadeWidth}px; top: 0; right: 0; z-index: 4;`,\r\n              },\r\n            },\r\n            [\r\n              h(\"canvas\", {\r\n                attributes: {\r\n                  width: fadeWidth,\r\n                  height: data.height,\r\n                },\r\n                hook: new FadeCanvasHook(\r\n                  fadeOut.type,\r\n                  fadeOut.shape,\r\n                  fadeOut.end - fadeOut.start,\r\n                  data.resolution\r\n                ),\r\n              }),\r\n            ]\r\n          )\r\n        );\r\n      }\r\n\r\n      return h(\r\n        `div.channel.channel-${channelNum}`,\r\n        {\r\n          attributes: {\r\n            style: `height: ${data.height}px; width: ${width}px; top: ${channelNum * data.height\r\n              }px; left: ${startX}px; position: absolute; margin: 0; padding: 0; z-index: 1;`,\r\n          },\r\n        },\r\n        channelChildren\r\n      );\r\n    });\r\n\r\n    waveformChildren.push(channels);\r\n    waveformChildren.push(this.renderOverlay(data));\r\n\r\n    // draw cursor selection on active track.\r\n    if (data.isActive === true) {\r\n      const cStartX = secondsToPixels(\r\n        data.timeSelection.start,\r\n        data.resolution,\r\n        data.sampleRate\r\n      );\r\n      const cEndX = secondsToPixels(\r\n        data.timeSelection.end,\r\n        data.resolution,\r\n        data.sampleRate\r\n      );\r\n      const cWidth = cEndX - cStartX + 1;\r\n      const cClassName = cWidth > 1 ? \".segment\" : \".point\";\r\n\r\n      waveformChildren.push(\r\n        h(`div.selection${cClassName}`, {\r\n          attributes: {\r\n            style: `position: absolute; width: ${cWidth}px; bottom: 0; top: 0; left: ${cStartX}px; z-index: 4;`,\r\n          },\r\n        })\r\n      );\r\n    }\r\n\r\n    const waveform = h(\r\n      \"div.waveform\",\r\n      {\r\n        attributes: {\r\n          style: `height: ${numChan * data.height}px; position: relative;`,\r\n        },\r\n      },\r\n      waveformChildren\r\n    );\r\n\r\n    const channelChildren = [];\r\n    let channelMargin = 0;\r\n\r\n    if (data.controls.show) {\r\n      channelChildren.push(this.renderControls(data));\r\n      channelMargin = data.controls.width;\r\n    }\r\n\r\n    channelChildren.push(waveform);\r\n\r\n    const audibleClass = data.shouldPlay ? \"\" : \".silent\";\r\n    const customClass =\r\n      this.customClass === undefined ? \"\" : `.${this.customClass}`;\r\n\r\n    return h(\r\n      `div.channel-wrapper${audibleClass}${customClass}`,\r\n      {\r\n        attributes: {\r\n          style: `margin-left: ${channelMargin}px; height: ${data.height * numChan\r\n            }px;`,\r\n        },\r\n      },\r\n      channelChildren\r\n    );\r\n  }\r\n\r\n  getTrackDetails() {\r\n    const info = {\r\n      src: this.src,\r\n      start: this.startTime,\r\n      end: this.endTime,\r\n      name: this.name,\r\n      customClass: this.customClass,\r\n      cuein: this.cueIn,\r\n      cueout: this.cueOut,\r\n      stereoPan: this.stereoPan,\r\n      gain: this.gain,\r\n      effects: this.effectsGraph,\r\n    };\r\n\r\n    if (this.fadeIn) {\r\n      const fadeIn = this.fades[this.fadeIn];\r\n\r\n      info.fadeIn = {\r\n        shape: fadeIn.shape,\r\n        duration: fadeIn.end - fadeIn.start,\r\n      };\r\n    }\r\n\r\n    if (this.fadeOut) {\r\n      const fadeOut = this.fades[this.fadeOut];\r\n\r\n      info.fadeOut = {\r\n        shape: fadeOut.shape,\r\n        duration: fadeOut.end - fadeOut.start,\r\n      };\r\n    }\r\n\r\n    return info;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}]}